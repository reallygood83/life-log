/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Le=Object.defineProperty;var Yt=Object.getOwnPropertyDescriptor;var Vt=Object.getOwnPropertyNames;var Ut=Object.prototype.hasOwnProperty;var qt=(n,t)=>{for(var e in t)Le(n,e,{get:t[e],enumerable:!0})},Jt=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Vt(t))!Ut.call(n,a)&&a!==e&&Le(n,a,{get:()=>t[a],enumerable:!(r=Yt(t,a))||r.enumerable});return n};var Qt=n=>Jt(Le({},"__esModule",{value:!0}),n);var Xr={};qt(Xr,{default:()=>Ce});module.exports=Qt(Xr);var De=require("obsidian");var Xt=/^-\s*\[(.)\]\s*(.+)$/,Zt={" ":"pending","\\":"inProgress",x:"completed","-":"skipped"},er={pending:" ",inProgress:"\\",completed:"x",skipped:"-"};function Pe(n,t){var p,m,g,h;let e=n.match(Xt);if(!e)return null;let r=(p=e[1])!=null?p:" ",a=(m=e[2])!=null?m:"",o=(g=Zt[r])!=null?g:"pending",s=a.split("|").map(y=>y.trim()),i=(h=s[0])!=null?h:"",l=s.slice(1),d=[],c,u;for(let y of l){let f=tr(y);f&&(d.push(f),f.key.toLowerCase()==="duration"&&(f.editable?c=$(f.value):u=f.value+(f.unit?` ${f.unit}`:"")))}return{state:o,name:i,params:d,targetDuration:c,recordedDuration:u,lineIndex:t}}function tr(n){var l,d,c;let t=n.indexOf(":");if(t===-1)return null;let e=n.substring(0,t).trim(),r=n.substring(t+1).trim(),a=r.match(/^\[([^\]]*)\](.*)$/);if(a){let u=(l=a[1])!=null?l:"",p=((d=a[2])!=null?d:"").trim();return{key:e,value:u,editable:!0,unit:p||void 0}}let o=r.split(/\s+/),s=(c=o[0])!=null?c:"",i=o.slice(1).join(" ")||void 0;return{key:e,value:s,editable:!1,unit:i}}function $(n){var s,i,l,d,c,u;let t=n.trim(),e=t.match(/^(\d+)s$/);if(e)return parseInt((s=e[1])!=null?s:"0",10);let r=t.match(/^(\d+):(\d{2})$/);if(r){let p=parseInt((i=r[1])!=null?i:"0",10),m=parseInt((l=r[2])!=null?l:"0",10);return p*60+m}let a=t.match(/^(\d+)m\s*(\d+)?s?$/);if(a){let p=parseInt((d=a[1])!=null?d:"0",10),m=parseInt((c=a[2])!=null?c:"0",10);return p*60+m}let o=t.match(/^(\d+)$/);return o?parseInt((u=o[1])!=null?u:"0",10):0}function w(n){let t=Math.floor(n/60),e=n%60;return`${t}:${e.toString().padStart(2,"0")}`}function x(n){let t=Math.floor(n/60),e=n%60;return t===0?`${e}s`:e===0?`${t}m`:`${t}m ${e}s`}function yt(n){return er[n]}function Me(n){let e=`- [${yt(n.state)}] ${n.name}`;for(let r of n.params)e+=" | ",e+=`${r.key}: `,r.editable?e+=`[${r.value}]`:e+=r.value,r.unit&&(e+=` ${r.unit}`);return e}var rr=["planned","started","completed"];function Ae(n){let t={state:"planned"};for(let e of n){let r=e.indexOf(":");if(r===-1)continue;let a=e.substring(0,r).trim().toLowerCase(),o=e.substring(r+1).trim();switch(a){case"title":o&&(t.title=o);break;case"state":rr.includes(o)&&(t.state=o);break;case"startdate":o&&(t.startDate=o);break;case"duration":o&&(t.duration=o);break;case"restduration":if(o){let s=$(o);s>0&&(t.restDuration=s)}break}}return t}function Ie(n){let t=[];return n.title!==void 0&&t.push(`title: ${n.title}`),t.push(`state: ${n.state}`),n.startDate!==void 0&&t.push(`startDate: ${n.startDate}`),n.duration!==void 0&&t.push(`duration: ${n.duration}`),n.restDuration!==void 0&&t.push(`restDuration: ${x(n.restDuration)}`),t}function oe(n){var l;let t=n.split(`
`),e=-1;for(let d=0;d<t.length;d++)if(((l=t[d])==null?void 0:l.trim())==="---"){e=d;break}let r=e>0?t.slice(0,e):[],a=Ae(r),o=e>=0?e+1:0,s=t.slice(o),i=[];for(let d=0;d<s.length;d++){let c=s[d];if(!c)continue;let u=Pe(c,d);u&&i.push(u)}return{metadata:a,exercises:i,rawLines:t,metadataEndIndex:e>=0?e:-1}}function $e(n){let t=[],e=Ie(n.metadata);t.push(...e),t.push("---");for(let r of n.exercises)t.push(Me(r));return t.join(`
`)}function kt(n,t,e,r){let a=structuredClone(n),o=a.exercises[t];if(!o)return n;let s=o.params.find(i=>i.key===e);return s&&(s.value=r),a}function R(n,t,e){let r=structuredClone(n),a=r.exercises[t];return a?(a.state=e,r):n}function se(n){let t=structuredClone(n);for(let e of t.exercises)for(let r of e.params)r.editable=!1;return t}function vt(n,t,e){let r=structuredClone(n),a=r.exercises[t];if(!a)return n;let o={state:"pending",name:"Rest",params:[{key:"Duration",value:`${e}s`,editable:!0}],targetDuration:e,lineIndex:a.lineIndex+1};r.exercises.splice(t+1,0,o);for(let s=t+2;s<r.exercises.length;s++){let i=r.exercises[s];i&&i.lineIndex++}return r}function St(n,t){let e=structuredClone(n),r=e.exercises[t];if(!r)return n;let a={...structuredClone(r),state:"pending",recordedDuration:void 0,lineIndex:r.lineIndex+1};for(let o of a.params)o.key.toLowerCase()==="duration"&&!o.editable&&(o.editable=r.targetDuration!==void 0);e.exercises.splice(t+1,0,a);for(let o=t+2;o<e.exercises.length;o++){let s=e.exercises[o];s&&s.lineIndex++}return e}function q(n,t,e){let r=structuredClone(n),a=r.exercises[t];if(!a)return n;let o=a.params.find(s=>s.key.toLowerCase()==="duration");return o?(o.value=e,o.editable=!1):a.params.push({key:"Duration",value:e,editable:!1}),a.recordedDuration=e,r}function Tt(){return{metadata:{title:"Sample Workout",state:"planned",restDuration:60},exercises:[{state:"pending",name:"Squats",params:[{key:"Weight",value:"60",editable:!0,unit:"kg"},{key:"Reps",value:"12",editable:!0}],lineIndex:0},{state:"pending",name:"Rest",params:[{key:"Duration",value:"60s",editable:!0}],targetDuration:60,lineIndex:1},{state:"pending",name:"Push-ups",params:[{key:"Reps",value:"15",editable:!0}],lineIndex:2},{state:"pending",name:"Rest",params:[{key:"Duration",value:"60s",editable:!0}],targetDuration:60,lineIndex:3},{state:"pending",name:"Dumbbell Rows",params:[{key:"Weight",value:"20",editable:!0,unit:"kg"},{key:"Reps",value:"10",editable:!0,unit:"/arm"}],lineIndex:4},{state:"pending",name:"Rest",params:[{key:"Duration",value:"60s",editable:!0}],targetDuration:60,lineIndex:5},{state:"pending",name:"Plank Hold",params:[{key:"Duration",value:"45s",editable:!0}],targetDuration:45,lineIndex:6},{state:"pending",name:"Rest",params:[{key:"Duration",value:"60s",editable:!0}],targetDuration:60,lineIndex:7},{state:"pending",name:"Lunges",params:[{key:"Reps",value:"10",editable:!0,unit:"/leg"}],lineIndex:8}],rawLines:[],metadataEndIndex:-1}}function bt(n){let t=[];n.metadata.title&&t.push(`title: ${n.metadata.title}`),t.push("state: planned"),t.push("startDate:"),t.push("duration:"),t.push("---");let e=new Set,r=[];for(let a of n.exercises)e.has(a.name)||(e.add(a.name),r.push(a));for(let a of r){let o=`- [ ] ${a.name}`;for(let s of a.params)if(o+=" | ",o+=`${s.key}: `,!(s.key.toLowerCase()==="duration"&&!a.targetDuration)){if(s.key.toLowerCase()==="duration"&&a.targetDuration){let i=Math.floor(a.targetDuration/60),l=a.targetDuration%60,d=i>0?`${i}m ${l}s`:`${l}s`;o+=`[${d}]`}else o+=`[${s.value}]`;s.unit&&(o+=` ${s.unit}`)}t.push(o)}return t.join(`
`)}function W(n,t,e,r=!1){switch(n.empty(),n.removeClass("timer-digital","timer-analog","timer-pomodoro"),n.addClass(`timer-${e}`),e){case"analog":or(n,t);break;case"pomodoro":ar(n,t,r);break;case"digital":default:xt(n,t,r);break}}function xt(n,t,e){let r=e?t.exerciseElapsed:t.workoutElapsed;n.createSpan({cls:"timer-value",text:w(r)}),n.createSpan({cls:"timer-indicator count-up",text:" \u25B2"})}function ar(n,t,e){var r,a;if(t.pomodoroEnabled&&t.pomodoroPhase){let o=t.pomodoroPhase==="work"?"\uC9D1\uC911":"\uD734\uC2DD",s=(r=t.pomodoroRemaining)!=null?r:0,i=(a=t.pomodoroProgress)!=null?a:0,l=n.createDiv({cls:"pomodoro-timer-wrapper"}),d=l.createDiv({cls:"pomodoro-text"});d.createSpan({cls:"pomodoro-phase",text:o}),d.createSpan({cls:"pomodoro-time",text:w(s)}),l.createDiv({cls:"pomodoro-progress-bar"}).createDiv({cls:"pomodoro-progress-fill",attr:{style:`width: ${i}%`}})}else xt(n,t,e)}function or(n,t){let e=t.workoutElapsed,r=40,a=r/2,o=r/2-2,s=e%60*6,i=e/60%60*6+e%60*.1,l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("width",`${r}`),l.setAttribute("height",`${r}`),l.setAttribute("viewBox",`0 0 ${r} ${r}`),l.classList.add("analog-clock-svg");let d=document.createElementNS("http://www.w3.org/2000/svg","circle");d.setAttribute("cx",`${a}`),d.setAttribute("cy",`${a}`),d.setAttribute("r",`${o}`),d.setAttribute("fill","none"),d.setAttribute("stroke","currentColor"),d.setAttribute("stroke-width","2"),l.appendChild(d);let c=document.createElementNS("http://www.w3.org/2000/svg","line");c.setAttribute("x1",`${a}`),c.setAttribute("y1",`${a}`),c.setAttribute("x2",`${a}`),c.setAttribute("y2",`${a-o*.7}`),c.setAttribute("stroke","currentColor"),c.setAttribute("stroke-width","2"),c.setAttribute("transform",`rotate(${i} ${a} ${a})`),l.appendChild(c);let u=document.createElementNS("http://www.w3.org/2000/svg","line");u.setAttribute("x1",`${a}`),u.setAttribute("y1",`${a}`),u.setAttribute("x2",`${a}`),u.setAttribute("y2",`${a-o*.85}`),u.setAttribute("stroke","var(--text-accent)"),u.setAttribute("stroke-width","1"),u.setAttribute("transform",`rotate(${s} ${a} ${a})`),l.appendChild(u);let p=document.createElementNS("http://www.w3.org/2000/svg","circle");p.setAttribute("cx",`${a}`),p.setAttribute("cy",`${a}`),p.setAttribute("r","2"),p.setAttribute("fill","currentColor"),l.appendChild(p),n.appendChild(l),n.setAttribute("title",`Total: ${w(e)}`)}function Re(n,t,e,r,a="digital"){let o=n.createDiv({cls:"workout-header"}),s=o.createDiv({cls:"workout-title"});if(s.textContent=t.title||"Workout",t.restDuration){let d=o.createDiv({cls:"workout-rest-duration"}),c=x(t.restDuration);d.setText(`Rest: ${c}`)}let l=o.createDiv({cls:"workout-header-timer"}).createSpan({cls:"workout-timer"});return t.state==="completed"&&t.duration?(l.textContent=t.duration,l.createSpan({cls:"workout-timer-indicator recorded",text:" \u2713"})):r&&e?W(l,e,a):(t.state,l.textContent="--:--"),{titleEl:s,timerEl:l}}function We(n,t,e="digital"){W(n,t,e)}var sr={pending:"\u25CB",inProgress:"\u25D0",completed:"\u2713",skipped:"\u2014"};function nr(n){let t=5381;for(let a=0;a<n.length;a++)t=(t<<5)+t^n.charCodeAt(a);let e=.618033988749895,r=Math.abs(t)%1e3/1e3;return Math.floor(r*e%1*360)}function wt(n){return n.params.some(t=>t.key.toLowerCase()!=="duration")}function Be(n,t,e,r,a,o,s,i){let l=!wt(t),d=n.createDiv({cls:`workout-exercise state-${t.state}${r?" active":""}${l?" simple":""}`}),c=nr(t.name);d.style.setProperty("--exercise-color",`hsl(${c}, 65%, 55%)`);let u=new Map,p=d.createDiv({cls:"workout-exercise-main"}),m=p.createSpan({cls:"workout-exercise-icon"});m.textContent=sr[t.state];let g=p.createSpan({cls:"workout-exercise-name"});if(g.textContent=t.name,wt(t)){let y=p.createSpan({cls:"workout-exercise-params"});for(let f of t.params){if(f.key.toLowerCase()==="duration")continue;let v=y.createSpan({cls:"workout-param"});if(f.unit||v.createSpan({cls:"workout-param-prefix",text:"\xD7"}),f.editable&&s!=="completed"){let S=v.createEl("input",{cls:"workout-param-input",type:"text",value:f.value});S.addEventListener("input",()=>{o.onParamChange(e,f.key,S.value)}),S.addEventListener("keydown",T=>{T.key==="Enter"&&S.blur()}),u.set(f.key,S)}else v.createSpan({cls:"workout-param-value",text:f.value});f.unit&&v.createSpan({cls:"workout-param-unit",text:` ${f.unit}`})}}let h=p.createSpan({cls:"workout-exercise-timer"});return t.state==="completed"&&t.recordedDuration?(h.textContent=t.recordedDuration,h.createSpan({cls:"timer-indicator recorded",text:" \u2713"})):r&&a?ne(h,a,t.targetDuration):t.targetDuration?(h.textContent=w(t.targetDuration),h.createSpan({cls:"timer-indicator count-down",text:" \u25BC"})):t.state==="pending"&&(h.textContent="--"),r&&s==="started"&&ir(d,e,o,i),{container:d,timerEl:h,inputs:u}}function ir(n,t,e,r){let a=n.createDiv({cls:"workout-exercise-controls"}),o=a.createEl("button",{cls:"workout-btn",text:"Pause"});o.addEventListener("click",()=>{o.textContent==="Pause"?(e.onPauseExercise(),o.textContent="Resume"):(e.onResumeExercise(),o.textContent="Pause")}),a.createEl("button",{cls:"workout-btn",text:"Skip"}).addEventListener("click",()=>{e.onExerciseSkip(t)});let i=a.createDiv({cls:"workout-btn-group"});i.createEl("button",{cls:"workout-btn",text:"+ Set"}).addEventListener("click",()=>{e.onExerciseAddSet(t)}),r!==void 0&&i.createEl("button",{cls:"workout-btn",text:"+ Rest"}).addEventListener("click",()=>{e.onExerciseAddRest(t)}),i.createEl("button",{cls:"workout-btn",text:"Next"}).addEventListener("click",()=>{e.onExerciseFinish(t)})}function ne(n,t,e){if(n.empty(),e!==void 0){let r=e-t.exerciseElapsed;r>0?(n.textContent=w(r),n.createSpan({cls:"timer-indicator count-down",text:" \u25BC"})):(n.textContent=w(Math.abs(r)),n.addClass("overtime"),n.createSpan({cls:"timer-indicator overtime",text:" \u26A0"}))}else n.textContent=w(t.exerciseElapsed),n.createSpan({cls:"timer-indicator count-up",text:" \u25B2"})}var A=null,Et=!1;function N(){if(!Et)try{A=new(window.AudioContext||window.webkitAudioContext),A.state==="suspended"&&A.resume(),Et=!0,console.log("[Life Log] AudioContext initialized")}catch(n){console.warn("[Life Log] Failed to initialize AudioContext:",n)}}function J(n="complete"){if(A||N(),!A){console.warn("[Life Log] AudioContext not available");return}A.state==="suspended"&&A.resume();try{switch(n){case"complete":lr(A);break;case"break":cr(A);break;case"warning":dr(A);break}}catch(t){console.warn("[Life Log] Failed to play sound:",t)}}function lr(n){let t=n.currentTime,e=n.createOscillator(),r=n.createGain();e.connect(r),r.connect(n.destination),e.frequency.value=523.25,e.type="sine",r.gain.setValueAtTime(.3,t),r.gain.exponentialRampToValueAtTime(.01,t+.3),e.start(t),e.stop(t+.3);let a=n.createOscillator(),o=n.createGain();a.connect(o),o.connect(n.destination),a.frequency.value=659.25,a.type="sine",o.gain.setValueAtTime(.3,t+.15),o.gain.exponentialRampToValueAtTime(.01,t+.45),a.start(t+.15),a.stop(t+.45);let s=n.createOscillator(),i=n.createGain();s.connect(i),i.connect(n.destination),s.frequency.value=783.99,s.type="sine",i.gain.setValueAtTime(.3,t+.3),i.gain.exponentialRampToValueAtTime(.01,t+.6),s.start(t+.3),s.stop(t+.6)}function cr(n){let t=n.currentTime,e=n.createOscillator(),r=n.createGain();e.connect(r),r.connect(n.destination),e.frequency.value=440,e.type="sine",r.gain.setValueAtTime(.2,t),r.gain.exponentialRampToValueAtTime(.01,t+.5),e.start(t),e.stop(t+.5);let a=n.createOscillator(),o=n.createGain();a.connect(o),o.connect(n.destination),a.frequency.value=349.23,a.type="sine",o.gain.setValueAtTime(.2,t+.3),o.gain.exponentialRampToValueAtTime(.01,t+.8),a.start(t+.3),a.stop(t+.8)}function dr(n){let t=n.currentTime;for(let e=0;e<3;e++){let r=n.createOscillator(),a=n.createGain();r.connect(a),a.connect(n.destination),r.frequency.value=880,r.type="square",a.gain.setValueAtTime(.15,t+e*.2),a.gain.exponentialRampToValueAtTime(.01,t+e*.2+.1),r.start(t+e*.2),r.stop(t+e*.2+.1)}}function Fe(n,t,e,r){let a=n.createDiv({cls:"workout-controls"});if(t==="planned"){let o=a.createEl("button",{cls:"workout-btn workout-btn-primary workout-btn-large"});o.createSpan({cls:"workout-btn-icon",text:"\u25B6"}),o.createSpan({text:"Start Workout"}),o.addEventListener("click",()=>{N(),e.onStartWorkout()})}else if(t==="completed"){let o=a.createSpan({cls:"workout-completed-label"});o.createSpan({cls:"workout-btn-icon",text:"\u2713"}),o.createSpan({text:"Completed"});let s=a.createEl("button",{cls:"workout-btn"});s.createSpan({cls:"workout-btn-icon",text:"\u{1F4CB}"}),s.createSpan({text:"Copy as Template"}),s.addEventListener("click",async()=>{let i=bt(r);await navigator.clipboard.writeText("```workout\n"+i+"\n```");let l=s.querySelector("span:last-child");if(l){let d=l.textContent;l.textContent="Copied!",setTimeout(()=>{l.textContent=d},1500)}})}return a}function Ct(n,t){let e=n.createDiv({cls:"workout-empty-state"});e.createDiv({cls:"workout-empty-message"}).createSpan({text:"This workout is empty"});let o=e.createDiv({cls:"workout-empty-action"}).createEl("button",{cls:"workout-btn workout-btn-primary workout-btn-large"});return o.createSpan({cls:"workout-btn-icon",text:"\u2728"}),o.createSpan({text:"Add Sample Workout"}),o.addEventListener("click",async()=>{await t()}),e}function Dt(n){let{el:t,parsed:e,callbacks:r,workoutId:a,timerManager:o,timerStyle:s}=n;t.empty();let i=t.createDiv({cls:`workout-container state-${e.metadata.state}`}),l=o.isTimerRunning(a),d=o.getTimerState(a),c=l?o.getActiveExerciseIndex(a):-1,{timerEl:u}=Re(i,e.metadata,d,l,s);if(e.exercises.length===0&&e.metadata.state==="planned"){Ct(i,r.onAddSample);return}let p=[],m=i.createDiv({cls:"workout-exercises"}),g=Math.max(...e.exercises.map(h=>h.name.length));m.style.setProperty("--max-name-chars",String(g));for(let h=0;h<e.exercises.length;h++){let y=e.exercises[h];if(!y)continue;let f=h===c,v=Be(m,y,h,f,f?d:null,r,e.metadata.state,e.metadata.restDuration);p.push(v)}if(Fe(i,e.metadata.state,r,e),i.addEventListener("focusout",h=>{let y=h.relatedTarget;(!y||!i.contains(y))&&r.onFlushChanges()}),l){let h=c,y=!1;o.subscribe(a,f=>{We(u,f,s);let v=o.getActiveExerciseIndex(a);if(v!==h)return;let S=p[v],T=e.exercises[v];S!=null&&S.timerEl&&T&&(ne(S.timerEl,f,T.targetDuration),!y&&T.targetDuration!==void 0&&f.exerciseElapsed>=T.targetDuration&&(y=!0,r.onExerciseFinish(v)))})}}var ie=class{constructor(){this.timers=new Map;this.intervalId=null;this.onAutoAdvance=null;this.onPomodoroPhaseChange=null}setAutoAdvanceCallback(t){this.onAutoAdvance=t}setPomodoroPhaseChangeCallback(t){this.onPomodoroPhaseChange=t}startWorkoutTimer(t,e=0,r){var s,i,l;let a=Date.now(),o=this.timers.get(t);o?(o.exerciseStartTime=a,o.exercisePausedTime=0,o.isPaused=!1,o.activeExerciseIndex=e,r!=null&&r.enabled&&(o.pomodoroEnabled=!0,o.pomodoroPhase="work",o.pomodoroCycle=1,o.pomodoroWorkDuration=r.workDuration,o.pomodoroBreakDuration=r.breakDuration,o.pomodoroPhaseStartTime=a,o.pomodoroPausedTime=0)):this.timers.set(t,{workoutId:t,workoutStartTime:a,exerciseStartTime:a,exercisePausedTime:0,isPaused:!1,activeExerciseIndex:e,callbacks:new Set,pomodoroEnabled:(s=r==null?void 0:r.enabled)!=null?s:!1,pomodoroPhase:"work",pomodoroCycle:1,pomodoroWorkDuration:(i=r==null?void 0:r.workDuration)!=null?i:25*60,pomodoroBreakDuration:(l=r==null?void 0:r.breakDuration)!=null?l:5*60,pomodoroPhaseStartTime:a,pomodoroPausedTime:0}),this.ensureInterval()}advanceExercise(t,e){let r=this.timers.get(t);r&&(r.exerciseStartTime=Date.now(),r.exercisePausedTime=0,r.isPaused=!1,r.activeExerciseIndex=e)}pauseExercise(t){let e=this.timers.get(t);if(!e||e.isPaused)return;e.isPaused=!0;let r=Date.now();e.exercisePausedTime+=r-e.exerciseStartTime,e.pomodoroEnabled&&(e.pomodoroPausedTime+=r-e.pomodoroPhaseStartTime)}resumeExercise(t){let e=this.timers.get(t);if(!e||!e.isPaused)return;e.isPaused=!1;let r=Date.now();e.exerciseStartTime=r,e.pomodoroEnabled&&(e.pomodoroPhaseStartTime=r)}stopWorkoutTimer(t){this.timers.delete(t),this.timers.size===0&&this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)}subscribe(t,e){let r=this.timers.get(t);if(!r)return()=>{};r.callbacks.add(e);let a=this.getTimerState(t);return a&&e(a),()=>{r.callbacks.delete(e)}}getTimerState(t){let e=this.timers.get(t);if(!e)return null;let r=Date.now(),a=Math.floor((r-e.workoutStartTime)/1e3),o;if(e.isPaused)o=Math.floor(e.exercisePausedTime/1e3);else{let i=r-e.exerciseStartTime;o=Math.floor((e.exercisePausedTime+i)/1e3)}let s={workoutElapsed:a,exerciseElapsed:o,isOvertime:!1};if(e.pomodoroEnabled){let i=e.pomodoroPhase==="work"?e.pomodoroWorkDuration:e.pomodoroBreakDuration,l;if(e.isPaused)l=Math.floor(e.pomodoroPausedTime/1e3);else{let u=r-e.pomodoroPhaseStartTime;l=Math.floor((e.pomodoroPausedTime+u)/1e3)}let d=Math.max(0,i-l),c=Math.min(100,l/i*100);s.pomodoroEnabled=!0,s.pomodoroPhase=e.pomodoroPhase,s.pomodoroCycle=e.pomodoroCycle,s.pomodoroElapsed=l,s.pomodoroRemaining=d,s.pomodoroProgress=c}return s}getActiveExerciseIndex(t){var r;let e=this.timers.get(t);return(r=e==null?void 0:e.activeExerciseIndex)!=null?r:0}setActiveExerciseIndex(t,e){let r=this.timers.get(t);r&&r.activeExerciseIndex!==e&&(r.activeExerciseIndex=e,r.exerciseStartTime=Date.now(),r.exercisePausedTime=0,r.isPaused=!1)}isTimerRunning(t){return this.timers.has(t)}isPaused(t){var r;let e=this.timers.get(t);return(r=e==null?void 0:e.isPaused)!=null?r:!1}getPomodoroPhase(t){let e=this.timers.get(t);return!e||!e.pomodoroEnabled?null:e.pomodoroPhase}ensureInterval(){this.intervalId===null&&(this.intervalId=window.setInterval(()=>{this.tick()},1e3))}tick(){for(let[t,e]of this.timers){let r=this.getTimerState(t);if(r){e.pomodoroEnabled&&!e.isPaused&&this.checkPomodoroPhaseComplete(t,e,r);for(let a of e.callbacks)a(r)}}}checkPomodoroPhaseComplete(t,e,r){if(!r.pomodoroRemaining||r.pomodoroRemaining>0)return;let a=Date.now(),o=e.pomodoroPhase;e.pomodoroPhase==="work"?(e.pomodoroPhase="break",J("break")):(e.pomodoroPhase="work",e.pomodoroCycle++,J("complete")),e.pomodoroPhaseStartTime=a,e.pomodoroPausedTime=0,this.onPomodoroPhaseChange&&this.onPomodoroPhaseChange(t,e.pomodoroPhase,e.pomodoroCycle)}checkAutoAdvance(t,e){if(e===void 0)return;let r=this.getTimerState(t);r&&r.exerciseElapsed>=e&&this.onAutoAdvance&&this.onAutoAdvance(t)}destroy(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timers.clear()}};var He=require("obsidian"),le=class{constructor(t){this.app=t;this.updateLocks=new Map}async withLock(t,e){let r=this.updateLocks.get(t);r&&await r;let a,o=new Promise(s=>{a=s});this.updateLocks.set(t,o);try{return await e()}finally{a(),this.updateLocks.get(t)===o&&this.updateLocks.delete(t)}}async updateCodeBlock(t,e,r,a){let o=this.app.vault.getAbstractFileByPath(t);if(!(o instanceof He.TFile)){console.error("File not found:",t);return}if(!e){console.error("No section info available");return}await this.withLock(t,async()=>{await this.app.vault.process(o,s=>{var v;let i=s.split(`
`),l=i[e.lineStart],d=l==null?void 0:l.trim().startsWith("```life-log"),c=l==null?void 0:l.trim().startsWith("```study-log"),u=l==null?void 0:l.trim().startsWith("```work-log"),p=l==null?void 0:l.trim().startsWith("```meal-log");if(!l||!d&&!c&&!u&&!p)return console.error("Stale sectionInfo: expected ```life-log, ```study-log, ```work-log, or ```meal-log at line",e.lineStart),s;if(a){let T=i.slice(e.lineStart+1,e.lineEnd).join(`
`).match(/^title:\s*(.+)$/m),b=(v=T==null?void 0:T[1])==null?void 0:v.trim();if(b&&b!==a)return console.error("Title mismatch: expected",a,"but found",b),s}let m=e.lineStart,g=e.lineEnd,h=i.slice(0,m+1),y=i.slice(g);return[...h,r,...y].join(`
`)})})}async insertLineAfter(t,e,r,a){let o=this.app.vault.getAbstractFileByPath(t);if(!(o instanceof He.TFile)){console.error("File not found:",t);return}if(!e){console.error("No section info available");return}await this.app.vault.process(o,s=>{let i=s.split(`
`),l=e.lineStart+1+r;return i.splice(l+1,0,a),i.join(`
`)})}};var j=require("obsidian"),Q=class{constructor(t,e){this.app=t;this.settings=e}async createLogFile(t,e){let r=new Date,a=this.buildFolderPath(r),o=this.buildFileName(r,t),s=(0,j.normalizePath)(`${a}/${o}`);await this.ensureFolderExists(a);let i=this.app.vault.getAbstractFileByPath(s);return i instanceof j.TFile?this.appendToExistingFile(i,t,e):this.createNewFile(s,t,r,e)}buildFolderPath(t){let e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0");return(0,j.normalizePath)(`${this.settings.logFolder}/${e}/${r}`)}buildFileName(t,e){return`${this.formatDate(t)}-${e}.md`}formatDate(t){let e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");switch(this.settings.dateFormat){case"YYYY/MM/DD":return`${e}/${r}/${a}`;case"DD-MM-YYYY":return`${a}-${r}-${e}`;default:return`${e}-${r}-${a}`}}async ensureFolderExists(t){if(this.app.vault.getAbstractFileByPath(t)instanceof j.TFolder)return;let r=t.split("/"),a="";for(let o of r)a=a?`${a}/${o}`:o,this.app.vault.getAbstractFileByPath(a)||await this.app.vault.createFolder(a)}async appendToExistingFile(t,e,r){let a=this.getBlockType(e),o=this.buildNewSection(e,r,a);return await this.app.vault.process(t,s=>s+`

---

`+o),t}getBlockType(t){switch(t){case"study":return"study-log";case"work":return"work-log";case"workout":return"life-log"}}async createNewFile(t,e,r,a){let o=this.getBlockType(e),s=this.buildFrontmatter(e,r),i=this.buildHeading(e,r),l=this.buildNewSection(e,a,o),d=`${s}

${i}

${l}`;return await this.app.vault.create(t,d)}buildFrontmatter(t,e){let r=this.formatDate(e),a=e.toISOString();return["---",`type: ${t}-log`,`date: ${r}`,`created: ${a}`,"---"].join(`
`)}buildHeading(t,e){let r=this.formatDate(e),a={study:"\u{1F4DA}",work:"\u{1F4BC}",workout:"\u{1F3CB}\uFE0F"},o={study:"\uD559\uC2B5",work:"\uC5C5\uBB34",workout:"\uC6B4\uB3D9"};return`# ${a[t]} ${r} ${o[t]} \uAE30\uB85D`}buildNewSection(t,e,r){let o=new Date().getHours();return[`## ${o<12?"\uC624\uC804":o<18?"\uC624\uD6C4":"\uC800\uB141"} ${{study:"\uD559\uC2B5",work:"\uC5C5\uBB34",workout:"\uC6B4\uB3D9"}[t]} \uC138\uC158`,"",`\`\`\`${r}`,e,"```"].join(`
`)}formatDateTime(t){let e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),o=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0");return`${e}-${r}-${a} ${o}:${s}`}};var ur=["planned","started","completed"];function Oe(n){let t={title:"",subject:"",state:"planned"};for(let e of n){let r=e.indexOf(":");if(r===-1)continue;let a=e.substring(0,r).trim().toLowerCase(),o=e.substring(r+1).trim();switch(a){case"title":t.title=o;break;case"subject":t.subject=o;break;case"state":ur.includes(o)&&(t.state=o);break;case"startdate":o&&(t.startDate=o);break;case"enddate":o&&(t.endDate=o);break;case"totalduration":o&&(t.totalDuration=o);break;case"focusscore":let s=parseInt(o);s>=1&&s<=5&&(t.focusScore=s);break;case"comprehensionscore":let i=parseInt(o);i>=1&&i<=5&&(t.comprehensionScore=i);break;case"tags":o&&(t.tags=o.split(",").map(l=>l.trim()).filter(l=>l));break}}return t}function Ne(n){let t=[];return n.title&&t.push(`title: ${n.title}`),n.subject&&t.push(`subject: ${n.subject}`),t.push(`state: ${n.state}`),n.startDate&&t.push(`startDate: ${n.startDate}`),n.endDate&&t.push(`endDate: ${n.endDate}`),n.totalDuration&&t.push(`totalDuration: ${n.totalDuration}`),n.focusScore&&t.push(`focusScore: ${n.focusScore}`),n.comprehensionScore&&t.push(`comprehensionScore: ${n.comprehensionScore}`),n.tags&&n.tags.length>0&&t.push(`tags: ${n.tags.join(", ")}`),t}var pr=/^-\s*\[(.)\]\s*(.+)$/,mr={" ":"pending","\\":"inProgress",x:"completed","-":"skipped"},gr={pending:" ",inProgress:"\\",completed:"x",skipped:"-"};function je(n,t){var u,p,m,g,h;let e=n.match(pr);if(!e)return null;let r=(u=e[1])!=null?u:" ",a=(p=e[2])!=null?p:"",o=(m=mr[r])!=null?m:"pending",s=a.split("|").map(y=>y.trim()),i=(g=s[0])!=null?g:"",l,d,c;for(let y=1;y<s.length;y++){let f=s[y];if(!f)continue;let v=f.indexOf(":");if(v===-1){c=f;continue}let S=f.substring(0,v).trim().toLowerCase(),T=f.substring(v+1).trim();if(S==="duration"){let b=T.match(/^\[([^\]]*)\]$/);b?l=$((h=b[1])!=null?h:"0"):d=T}else c?c+=" | "+f:c=f}return{state:o,name:i,targetDuration:l,recordedDuration:d,notes:c,lineIndex:t}}function Lt(n){return gr[n]}function Ge(n){let e=`- [${Lt(n.state)}] ${n.name}`;return n.targetDuration!==void 0&&n.state==="pending"?e+=` | Duration: [${fr(n.targetDuration)}]`:n.recordedDuration&&(e+=` | Duration: ${n.recordedDuration}`),n.notes&&(e+=` | ${n.notes}`),e}function fr(n){let t=Math.floor(n/60),e=n%60;return t===0?`${e}s`:e===0?`${t}m`:`${t}m ${e}s`}function ce(n){var l;let t=n.split(`
`),e=-1;for(let d=0;d<t.length;d++)if(((l=t[d])==null?void 0:l.trim())==="---"){e=d;break}let r=e>0?t.slice(0,e):[],a=Oe(r),o=e>=0?e+1:0,s=t.slice(o),i=[];for(let d=0;d<s.length;d++){let c=s[d];if(!c)continue;let u=je(c,d);u&&i.push(u)}return{metadata:a,tasks:i,rawLines:t,metadataEndIndex:e>=0?e:-1}}function Pt(n){let t=[],e=Ne(n.metadata);t.push(...e),t.push("---");for(let r of n.tasks)t.push(Ge(r));return t.join(`
`)}function G(n,t,e){let r=structuredClone(n),a=r.tasks[t];return a?(a.state=e,r):n}function de(n,t,e){let r=structuredClone(n),a=r.tasks[t];return a?(a.recordedDuration=e,a.targetDuration=void 0,r):n}function Mt(n,t,e){let r=structuredClone(n);return r.metadata.focusScore=t,r.metadata.comprehensionScore=e,r}function ze(n,t,e,r,a="digital"){let o=n.createDiv({cls:"study-header"}),s=o.createDiv({cls:"study-header-top"}),i=s.createDiv({cls:"study-title"}),l=kr(t.subject);i.createSpan({cls:"study-subject-icon",text:l}),i.createSpan({cls:"study-subject-name",text:t.subject||"\uD559\uC2B5"}),t.title&&i.createSpan({cls:"study-title-text",text:` - ${t.title}`});let d=s.createDiv({cls:"study-timer"});hr(d,t,e,r,a);let c=o.createDiv({cls:"study-scores"});if(t.state==="completed"&&yr(c,t.focusScore,t.comprehensionScore),t.tags&&t.tags.length>0){let u=o.createDiv({cls:"study-tags"});for(let p of t.tags)u.createSpan({cls:"study-tag",text:p})}return{titleEl:i,timerEl:d,scoresEl:c}}function hr(n,t,e,r,a){t.state==="completed"&&t.totalDuration?(n.createSpan({cls:"study-timer-value",text:t.totalDuration}),n.createSpan({cls:"study-timer-indicator recorded",text:" \u2713"})):r&&e?W(n,e,a):n.createSpan({cls:"study-timer-value",text:"--:--"})}function yr(n,t,e){if(t){let r=n.createDiv({cls:"study-score-item"});r.createSpan({cls:"study-score-label",text:"\uC9D1\uC911\uB3C4: "}),At(r,t)}if(e){let r=n.createDiv({cls:"study-score-item"});r.createSpan({cls:"study-score-label",text:"\uC774\uD574\uB3C4: "}),At(r,e)}}function At(n,t){let e=n.createSpan({cls:`study-stars score-${t}`});for(let r=1;r<=5;r++)e.createSpan({cls:`study-star ${r<=t?"filled":"empty"}`,text:r<=t?"\u2605":"\u2606"})}function kr(n){return{\uC218\uD559:"\u{1F4D0}",\uC601\uC5B4:"\u{1F524}",\uD504\uB85C\uADF8\uB798\uBC0D:"\u{1F4BB}",\uB3C5\uC11C:"\u{1F4D6}",\uAE30\uD0C0:"\u{1F4DD}"}[n]||"\u{1F4DA}"}function _e(n,t,e="digital"){W(n,t,e)}function Ke(n,t,e,r,a,o,s){let i=n.createDiv({cls:`study-task state-${t.state} ${r?"active":""}`}),l=i.createDiv({cls:"study-task-main"}),d=l.createSpan({cls:"study-task-icon"});d.textContent=Sr(t.state);let c=l.createSpan({cls:"study-task-name"});c.textContent=t.name;let u=null;if(t.notes){let p=l.createSpan({cls:"study-task-notes"});p.textContent=t.notes}if(u=l.createSpan({cls:"study-task-timer"}),t.state==="completed"&&t.recordedDuration)u.textContent=t.recordedDuration,u.createSpan({cls:"timer-indicator recorded",text:" \u2713"});else if(r&&a)ue(u,a,t.targetDuration);else if(t.targetDuration){let p=Math.floor(t.targetDuration/60),m=t.targetDuration%60;u.textContent=`[${p}m ${m>0?m+"s":""}]`,u.classList.add("target")}return r&&s==="started"&&vr(i,e,o),{taskEl:i,timerEl:u}}function vr(n,t,e){let r=n.createDiv({cls:"study-task-controls"});r.createEl("button",{cls:"study-btn",text:"\u2713 \uC644\uB8CC"}).addEventListener("click",()=>e.onTaskFinish(t)),r.createEl("button",{cls:"study-btn",text:"\u23ED \uAC74\uB108\uB6F0\uAE30"}).addEventListener("click",()=>e.onTaskSkip(t))}function Sr(n){switch(n){case"completed":return"\u2713";case"inProgress":return"\u25B6";case"skipped":return"\u2013";default:return"\u25CB"}}function ue(n,t,e){if(n.empty(),n.classList.remove("overtime"),e!==void 0){let r=e-t.exerciseElapsed;r<0?(n.classList.add("overtime"),n.textContent=`+${w(Math.abs(r))}`,n.createSpan({cls:"timer-indicator overtime",text:" !"})):(n.textContent=w(r),n.createSpan({cls:"timer-indicator count-down",text:" \u25BC"}))}else n.textContent=w(t.exerciseElapsed),n.createSpan({cls:"timer-indicator count-up",text:" \u25B2"})}function Ye(n,t,e,r){let a=n.createDiv({cls:"study-controls"});if(t==="planned"){let o=a.createEl("button",{cls:"study-btn study-btn-primary study-btn-large"});o.createSpan({cls:"study-btn-icon",text:"\u25B6"}),o.createSpan({text:"\uD559\uC2B5 \uC2DC\uC791"}),o.addEventListener("click",()=>{N(),e.onStartStudy()})}else if(t==="started"){let o=a.createEl("button",{cls:"study-btn study-btn-primary"});o.createSpan({cls:"study-btn-icon",text:"\u2713"}),o.createSpan({text:"\uD559\uC2B5 \uC644\uB8CC"}),o.addEventListener("click",()=>e.onOpenSelfEval())}else if(t==="completed"){let o=a.createSpan({cls:"study-completed-label"});o.createSpan({cls:"study-btn-icon",text:"\u2713"}),o.createSpan({text:"\uC644\uB8CC\uB428"});let s=a.createEl("button",{cls:"study-btn"});s.createSpan({cls:"study-btn-icon",text:"\u{1F4CB}"}),s.createSpan({text:"\uD15C\uD50C\uB9BF \uBCF5\uC0AC"}),s.addEventListener("click",async()=>{let i=Tr(r);await navigator.clipboard.writeText("```study-log\n"+i+"\n```");let l=s.querySelector("span:last-child");if(l){let d=l.textContent;l.textContent="Copied!",setTimeout(()=>{l.textContent=d},1500)}})}return a}function Tr(n){let t=[];n.metadata.subject&&t.push(`subject: ${n.metadata.subject}`),t.push("state: planned"),t.push("---");let e=new Set;for(let r of n.tasks)if(!e.has(r.name)){e.add(r.name);let a=`- [ ] ${r.name}`;if(r.targetDuration){let o=Math.floor(r.targetDuration/60),s=r.targetDuration%60;a+=` | Duration: [${o}m${s>0?" "+s+"s":""}]`}t.push(a)}return t.join(`
`)}var It=0,br=3e3;function pe(n,t,e="complete"){let r=Date.now();r-It<br||(It=r,n.enableSound&&J(e),n.enableNotification&&xr(t,e))}function xr(n,t){if("Notification"in window)if(Notification.permission==="granted"){let e;t==="break"?e="\uD734\uC2DD \uC2DC\uAC04\uC774 \uB05D\uB0AC\uC2B5\uB2C8\uB2E4! \uB2E4\uC2DC \uC9D1\uC911\uD558\uC138\uC694.":n?e=`"${n}" \uC644\uB8CC!`:e="\uD0C0\uC774\uBA38\uAC00 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4!",new Notification("Life Log",{body:e,icon:void 0,silent:!0})}else Notification.permission!=="denied"&&Notification.requestPermission()}function $t(n){let{el:t,parsed:e,callbacks:r,studyId:a,timerManager:o,enableTimerSound:s=!0,enableNotification:i=!1,timerStyle:l}=n;t.empty();let d=t.createDiv({cls:`study-container state-${e.metadata.state}`}),c=o.isTimerRunning(a),u=o.getTimerState(a),p=c?o.getActiveExerciseIndex(a):-1,m=ze(d,e.metadata,u,c,l);if(e.tasks.length===0&&e.metadata.state==="planned"){wr(d);return}let g=[],h=d.createDiv({cls:"study-tasks"});for(let y=0;y<e.tasks.length;y++){let f=e.tasks[y];if(!f)continue;let v=y===p,S=Ke(h,f,y,v,v?u:null,r,e.metadata.state);g.push(S)}if(Ye(d,e.metadata.state,r,e),d.addEventListener("focusout",y=>{let f=y.relatedTarget;(!f||!d.contains(f))&&r.onFlushChanges()}),c){let y=p,f=p>=0?e.tasks[p]:null,v=(f==null?void 0:f.targetDuration)!==void 0&&u?u.exerciseElapsed>=f.targetDuration:!1;o.subscribe(a,S=>{_e(m.timerEl,S,l);let T=o.getActiveExerciseIndex(a);if(T!==y){y=T;let I=e.tasks[T];v=(I==null?void 0:I.targetDuration)!==void 0?S.exerciseElapsed>=I.targetDuration:!1;return}let b=g[T],C=e.tasks[T];b!=null&&b.timerEl&&C&&(ue(b.timerEl,S,C.targetDuration),!v&&C.targetDuration!==void 0&&S.exerciseElapsed>=C.targetDuration&&(v=!0,pe({enableSound:s,enableNotification:i},C.name)))})}}function wr(n){n.createDiv({cls:"study-empty-state"}).createDiv({cls:"study-empty-message",text:"\uD559\uC2B5 \uD56D\uBAA9\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. \uCF54\uB4DC\uBE14\uB85D\uC5D0 \uD56D\uBAA9\uC744 \uCD94\uAC00\uD574\uC8FC\uC138\uC694."})}var Er=["planned","started","completed"];function Ve(n){let t={title:"",state:"planned"};for(let e of n){let r=e.indexOf(":");if(r===-1)continue;let a=e.substring(0,r).trim().toLowerCase(),o=e.substring(r+1).trim();switch(a){case"title":t.title=o;break;case"state":Er.includes(o)&&(t.state=o);break;case"startdate":o&&(t.startDate=o);break;case"enddate":o&&(t.endDate=o);break;case"totalduration":o&&(t.totalDuration=o);break;case"tags":o&&(t.tags=o.split(",").map(s=>s.trim()).filter(s=>s));break}}return t}function Ue(n){let t=[];return n.title&&t.push(`title: ${n.title}`),t.push(`state: ${n.state}`),n.startDate&&t.push(`startDate: ${n.startDate}`),n.endDate&&t.push(`endDate: ${n.endDate}`),n.totalDuration&&t.push(`totalDuration: ${n.totalDuration}`),n.tags&&n.tags.length>0&&t.push(`tags: ${n.tags.join(", ")}`),t}var Cr=/^-\s*\[(.)\]\s*(.+)$/,Dr={" ":"pending","\\":"inProgress",x:"completed","-":"skipped"},Lr={pending:" ",inProgress:"\\",completed:"x",skipped:"-"};function qe(n,t){var p,m,g,h,y;let e=n.match(Cr);if(!e)return null;let r=(p=e[1])!=null?p:" ",a=(m=e[2])!=null?m:"",o=(g=Dr[r])!=null?g:"pending",s=a.split("|").map(f=>f.trim()),i=(h=s[0])!=null?h:"",l="medium",d,c,u;for(let f=1;f<s.length;f++){let v=s[f];if(!v)continue;let S=v.indexOf(":");if(S===-1){u=u?u+" | "+v:v;continue}let T=v.substring(0,S).trim().toLowerCase(),b=v.substring(S+1).trim();if(T==="priority")["high","medium","low"].includes(b.toLowerCase())&&(l=b.toLowerCase());else if(T==="expected"){let C=b.match(/^\[([^\]]*)\]$/);C?d=$((y=C[1])!=null?y:"0"):d=$(b)}else T==="actual"?b&&b!==""&&(c=b):u=u?u+" | "+v:v}return{state:o,name:i,priority:l,expectedDuration:d,actualDuration:c,notes:u,lineIndex:t}}function Rt(n){return Lr[n]}function Je(n){let e=`- [${Rt(n.state)}] ${n.name}`;return e+=` | Priority: ${n.priority}`,n.expectedDuration!==void 0&&(e+=` | Expected: [${Pr(n.expectedDuration)}]`),n.actualDuration&&(e+=` | Actual: ${n.actualDuration}`),n.notes&&(e+=` | ${n.notes}`),e}function Pr(n){let t=Math.floor(n/3600),e=Math.floor(n%3600/60),r=n%60;return t>0?e===0&&r===0?`${t}h`:r===0?`${t}h ${e}m`:`${t}h ${e}m ${r}s`:e===0?`${r}s`:r===0?`${e}m`:`${e}m ${r}s`}function me(n){var l;let t=n.split(`
`),e=-1;for(let d=0;d<t.length;d++)if(((l=t[d])==null?void 0:l.trim())==="---"){e=d;break}let r=e>0?t.slice(0,e):[],a=Ve(r),o=e>=0?e+1:0,s=t.slice(o),i=[];for(let d=0;d<s.length;d++){let c=s[d];if(!c)continue;let u=qe(c,d);u&&i.push(u)}return{metadata:a,tasks:i,rawLines:t,metadataEndIndex:e>=0?e:-1}}function Wt(n){let t=[],e=Ue(n.metadata);t.push(...e),t.push("---");for(let r of n.tasks)t.push(Je(r));return t.join(`
`)}function z(n,t,e){let r=structuredClone(n),a=r.tasks[t];return a?(a.state=e,r):n}function ge(n,t,e){let r=structuredClone(n),a=r.tasks[t];return a?(a.actualDuration=e,r):n}function Qe(n,t,e,r,a="digital"){let o=n.createDiv({cls:"work-header"}),s=o.createDiv({cls:"work-header-top"}),i=s.createDiv({cls:"work-title"});i.createSpan({cls:"work-icon",text:"\u{1F4BC}"}),i.createSpan({cls:"work-title-text",text:t.title||"\uC5C5\uBB34"});let l=s.createDiv({cls:"work-timer"});if(Mr(l,t,e,r,a),t.tags&&t.tags.length>0){let d=o.createDiv({cls:"work-tags"});for(let c of t.tags)d.createSpan({cls:"work-tag",text:c})}return{titleEl:i,timerEl:l}}function Mr(n,t,e,r,a){t.state==="completed"&&t.totalDuration?(n.createSpan({cls:"work-timer-value",text:t.totalDuration}),n.createSpan({cls:"work-timer-indicator recorded",text:" \u2713"})):r&&e?W(n,e,a):n.createSpan({cls:"work-timer-value",text:"--:--"})}function Xe(n,t,e="digital"){W(n,t,e)}var Ar={high:"#E74C3C",medium:"#F39C12",low:"#3498DB"},Ir={high:"\uB192\uC74C",medium:"\uBCF4\uD1B5",low:"\uB0AE\uC74C"};function Ze(n,t,e,r,a,o,s){let i=n.createDiv({cls:`work-task state-${t.state} priority-${t.priority} ${r?"active":""}`}),l=i.createDiv({cls:"work-task-main"}),d=l.createSpan({cls:"work-task-icon"});d.textContent=Br(t.state);let c=l.createSpan({cls:"work-task-priority"});c.style.backgroundColor=Ar[t.priority],c.setAttribute("title",Ir[t.priority]);let u=l.createSpan({cls:"work-task-name"});u.textContent=t.name;let p=null;if(t.notes){let m=l.createSpan({cls:"work-task-notes"});m.textContent=t.notes}return p=l.createDiv({cls:"work-task-timer-group"}),t.state==="completed"&&t.actualDuration?$r(p,t):r&&a?fe(p,a,t.expectedDuration):t.expectedDuration&&Rr(p,t.expectedDuration),r&&s==="started"&&Wr(i,e,o),{taskEl:i,timerEl:p}}function $r(n,t){if(t.expectedDuration){let r=n.createSpan({cls:"work-timer-expected"});r.textContent=`\uC608\uC0C1: ${et(t.expectedDuration)}`}let e=n.createSpan({cls:"work-timer-actual"});e.textContent=`\uC2E4\uC81C: ${t.actualDuration}`,e.createSpan({cls:"timer-indicator recorded",text:" \u2713"})}function Rr(n,t){let e=n.createSpan({cls:"work-timer-expected target"});e.textContent=`\uC608\uC0C1: [${et(t)}]`}function Wr(n,t,e){let r=n.createDiv({cls:"work-task-controls"});r.createEl("button",{cls:"work-btn",text:"\u2713 \uC644\uB8CC"}).addEventListener("click",()=>e.onTaskFinish(t)),r.createEl("button",{cls:"work-btn",text:"\u23ED \uAC74\uB108\uB6F0\uAE30"}).addEventListener("click",()=>e.onTaskSkip(t))}function Br(n){switch(n){case"completed":return"\u2713";case"inProgress":return"\u25B6";case"skipped":return"\u2013";default:return"\u25CB"}}function fe(n,t,e){if(n.empty(),n.classList.remove("overtime"),e!==void 0){let r=n.createSpan({cls:"work-timer-expected"});r.textContent=`\uC608\uC0C1: ${et(e)}`;let a=n.createSpan({cls:"work-timer-actual"});t.exerciseElapsed>e?(n.classList.add("overtime"),a.textContent=`\uC2E4\uC81C: ${w(t.exerciseElapsed)}`,a.createSpan({cls:"timer-indicator overtime",text:" !"})):(a.textContent=`\uC2E4\uC81C: ${w(t.exerciseElapsed)}`,a.createSpan({cls:"timer-indicator count-up",text:" \u25B2"}))}else{let r=n.createSpan({cls:"work-timer-actual"});r.textContent=w(t.exerciseElapsed),r.createSpan({cls:"timer-indicator count-up",text:" \u25B2"})}}function et(n){let t=Math.floor(n/3600),e=Math.floor(n%3600/60),r=n%60;return t>0?e===0&&r===0?`${t}h`:r===0?`${t}h ${e}m`:`${t}h ${e}m`:e===0?`${r}s`:r===0?`${e}m`:`${e}m ${r}s`}function tt(n,t,e,r){let a=n.createDiv({cls:"work-controls"});if(t==="planned"){let o=a.createEl("button",{cls:"work-btn work-btn-primary work-btn-large"});o.createSpan({cls:"work-btn-icon",text:"\u25B6"}),o.createSpan({text:"\uC5C5\uBB34 \uC2DC\uC791"}),o.addEventListener("click",async()=>{console.log("[Life Log] Work start button clicked"),N();try{await e.onStartWork(),console.log("[Life Log] onStartWork completed")}catch(s){console.error("[Life Log] onStartWork error:",s)}})}else if(t==="started"){let o=a.createEl("button",{cls:"work-btn work-btn-primary"});o.createSpan({cls:"work-btn-icon",text:"\u2713"}),o.createSpan({text:"\uC5C5\uBB34 \uC644\uB8CC"}),o.addEventListener("click",()=>e.onFinishWork())}else if(t==="completed"){let o=a.createSpan({cls:"work-completed-label"});o.createSpan({cls:"work-btn-icon",text:"\u2713"}),o.createSpan({text:"\uC644\uB8CC\uB428"}),Fr(a,r);let s=a.createEl("button",{cls:"work-btn"});s.createSpan({cls:"work-btn-icon",text:"\u{1F4CB}"}),s.createSpan({text:"\uD15C\uD50C\uB9BF \uBCF5\uC0AC"}),s.addEventListener("click",async()=>{let i=Hr(r);await navigator.clipboard.writeText("```work-log\n"+i+"\n```");let l=s.querySelector("span:last-child");if(l){let d=l.textContent;l.textContent="Copied!",setTimeout(()=>{l.textContent=d},1500)}})}return a}function Fr(n,t){let e=n.createDiv({cls:"work-stats"}),r=t.tasks.filter(i=>i.state==="completed").length,a=t.tasks.length;e.createSpan({cls:"work-stat",text:`\uC644\uB8CC: ${r}/${a}`});let o=t.tasks.filter(i=>i.priority==="high"&&i.state==="completed").length,s=t.tasks.filter(i=>i.priority==="high").length;if(s>0){let i=e.createSpan({cls:"work-stat high-priority"});i.createSpan({cls:"priority-dot high"}),i.createSpan({text:` \uC911\uC694: ${o}/${s}`})}}function Hr(n){let t=[];t.push("state: planned"),t.push("---");let e=new Set;for(let r of n.tasks)if(!e.has(r.name)){e.add(r.name);let a=`- [ ] ${r.name} | Priority: ${r.priority}`;r.expectedDuration&&(a+=` | Expected: [${Or(r.expectedDuration)}]`),t.push(a)}return t.join(`
`)}function Or(n){let t=Math.floor(n/3600),e=Math.floor(n%3600/60);return t>0?e===0?`${t}h`:`${t}h ${e}m`:`${e}m`}function Bt(n){let{el:t,parsed:e,callbacks:r,workId:a,timerManager:o,enableTimerSound:s=!0,enableNotification:i=!1,timerStyle:l}=n;t.empty();let d=t.createDiv({cls:`work-container state-${e.metadata.state}`}),c=o.isTimerRunning(a),u=o.getTimerState(a),p=c?o.getActiveExerciseIndex(a):-1,m=Qe(d,e.metadata,u,c,l);if(e.tasks.length===0&&e.metadata.state==="planned"){Nr(d);return}let g=[],h=d.createDiv({cls:"work-tasks"});for(let y=0;y<e.tasks.length;y++){let f=e.tasks[y];if(!f)continue;let v=Ze(h,f,y,y===p,y===p?u:null,r,e.metadata.state);g.push(v)}if(tt(d,e.metadata.state,r,e),d.addEventListener("focusout",y=>{let f=y.relatedTarget;(!f||!d.contains(f))&&r.onFlushChanges()}),c){let y=p,f=p>=0?e.tasks[p]:null,v=(f==null?void 0:f.expectedDuration)!==void 0&&u?u.exerciseElapsed>=f.expectedDuration:!1;o.subscribe(a,S=>{Xe(m.timerEl,S,l);let T=o.getActiveExerciseIndex(a);if(T!==y){y=T;let I=e.tasks[T];v=(I==null?void 0:I.expectedDuration)!==void 0?S.exerciseElapsed>=I.expectedDuration:!1;return}let b=g[T],C=e.tasks[T];b!=null&&b.timerEl&&C&&(fe(b.timerEl,S,C.expectedDuration),!v&&C.expectedDuration!==void 0&&S.exerciseElapsed>=C.expectedDuration&&(v=!0,pe({enableSound:s,enableNotification:i},C.name)))})}}function Nr(n){n.createDiv({cls:"work-empty-state"}).createDiv({cls:"work-empty-message",text:"\uC5C5\uBB34 \uD56D\uBAA9\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. \uCF54\uB4DC\uBE14\uB85D\uC5D0 \uD56D\uBAA9\uC744 \uCD94\uAC00\uD574\uC8FC\uC138\uC694."})}var jr=["planned","started","completed"],Gr=["breakfast","lunch","dinner","snack"];function rt(n){let t={title:"",mealType:"lunch",state:"planned"};for(let e of n){let r=e.indexOf(":");if(r===-1)continue;let a=e.substring(0,r).trim().toLowerCase(),o=e.substring(r+1).trim();switch(a){case"title":t.title=o;break;case"mealtype":Gr.includes(o.toLowerCase())&&(t.mealType=o.toLowerCase());break;case"state":jr.includes(o)&&(t.state=o);break;case"date":o&&(t.date=o);break;case"photo":o&&(t.photo=o);break;case"notes":o&&(t.notes=o);break}}return t}function at(n){let t=[];return n.title&&t.push(`title: ${n.title}`),t.push(`mealType: ${n.mealType}`),t.push(`state: ${n.state}`),n.date&&t.push(`date: ${n.date}`),n.photo&&t.push(`photo: ${n.photo}`),n.notes&&t.push(`notes: ${n.notes}`),t}var zr=/^-\s*\[(.)\]\s*(.+)$/;var _r={pending:" ",completed:"x"};function ot(n,t){var s,i;let e=n.match(zr);if(!e)return null;let r=(s=e[1])!=null?s:" ",a=((i=e[2])!=null?i:"").trim();return{state:r==="x"?"completed":"pending",name:a,lineIndex:t}}function Ft(n){return _r[n]}function st(n){return`- [${Ft(n.state)}] ${n.name}`}function he(n){var l;let t=n.split(`
`),e=-1;for(let d=0;d<t.length;d++)if(((l=t[d])==null?void 0:l.trim())==="---"){e=d;break}let r=e>0?t.slice(0,e):[],a=rt(r),o=e>=0?e+1:0,s=t.slice(o),i=[];for(let d=0;d<s.length;d++){let c=s[d];if(!c)continue;let u=ot(c,d);u&&i.push(u)}return{metadata:a,foods:i,rawLines:t,metadataEndIndex:e>=0?e:-1}}function Ht(n){let t=[],e=at(n.metadata);t.push(...e),t.push("---");for(let r of n.foods)t.push(st(r));return t.join(`
`)}function Ot(n,t){let e=structuredClone(n),r={state:"pending",name:t,lineIndex:e.foods.length};return e.foods.push(r),e}function Nt(n,t){let e=structuredClone(n);if(t<0||t>=e.foods.length)return n;e.foods.splice(t,1);for(let r=t;r<e.foods.length;r++){let a=e.foods[r];a&&(a.lineIndex=r)}return e}function jt(n,t){let e=structuredClone(n);return e.metadata.photo=t,e}function nt(n,t){let e=structuredClone(n),r=e.foods[t];return r?(r.state=r.state==="completed"?"pending":"completed",e):n}var Kr={breakfast:{icon:"\u{1F305}",label:"\uC544\uCE68"},lunch:{icon:"\u2600\uFE0F",label:"\uC810\uC2EC"},dinner:{icon:"\u{1F319}",label:"\uC800\uB141"},snack:{icon:"\u{1F36A}",label:"\uAC04\uC2DD"}};function it(n,t){let e=n.createDiv({cls:"meal-header"}),r=e.createDiv({cls:"meal-header-top"}),a=r.createDiv({cls:"meal-title"}),o=Kr[t.mealType];a.createSpan({cls:"meal-icon",text:o.icon}),a.createSpan({cls:"meal-title-text",text:t.title||o.label}),t.date&&r.createDiv({cls:"meal-date"}).createSpan({text:t.date});let s=null;if(t.photo){s=e.createDiv({cls:"meal-photo-container"});let i=s.createDiv({cls:"meal-photo"});i.innerHTML=`<span class="meal-photo-embed">${t.photo}</span>`}if(t.notes){let i=e.createDiv({cls:"meal-notes"});i.createSpan({cls:"meal-notes-icon",text:"\u{1F4DD}"}),i.createSpan({cls:"meal-notes-text",text:t.notes})}return{titleEl:a,photoEl:s}}function lt(n,t,e,r,a){let o=n.createDiv({cls:`meal-food-item state-${t.state}`}),s=o.createDiv({cls:"meal-food-content"}),i=s.createEl("input",{type:"checkbox",cls:"meal-food-checkbox"});i.checked=t.state==="completed",i.disabled=a==="completed",i.addEventListener("change",async()=>{await r.onFoodToggle(e)});let l=s.createDiv({cls:"meal-food-name"});return l.setText(t.name),a!=="completed"&&s.createEl("button",{cls:"meal-food-remove-btn",text:"\u2715"}).addEventListener("click",async c=>{c.preventDefault(),await r.onRemoveFood(e)}),{container:o,checkboxEl:i,nameEl:l}}function ct(n,t,e,r){let a=n.createDiv({cls:"meal-controls"});if(t==="completed"){Yr(a);return}let o=a.createDiv({cls:"meal-add-food"}),s=o.createEl("input",{type:"text",cls:"meal-food-input",placeholder:"\uC74C\uC2DD \uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694..."}),i=o.createEl("button",{cls:"meal-add-btn",text:"\u2795 \uCD94\uAC00"}),l=async()=>{let d=s.value.trim();d&&(await e.onAddFood(d),s.value="")};i.addEventListener("click",l),s.addEventListener("keypress",async d=>{d.key==="Enter"&&await l()}),r.foods.length>0&&a.createEl("button",{cls:"meal-complete-btn",text:"\u2713 \uC2DD\uC0AC \uC644\uB8CC"}).addEventListener("click",async()=>{await e.onCompleteMeal()})}function Yr(n){let t=n.createDiv({cls:"meal-completed-badge"});t.createSpan({cls:"meal-completed-icon",text:"\u2713"}),t.createSpan({cls:"meal-completed-text",text:"\uC2DD\uC0AC \uC644\uB8CC"})}function Gt(n){let{el:t,parsed:e,callbacks:r,app:a}=n;t.empty();let o=t.createDiv({cls:`meal-container state-${e.metadata.state}`}),s=it(o,e.metadata);s.photoEl&&e.metadata.photo&&Ur(s.photoEl,e.metadata.photo,a);let i=o.createDiv({cls:"meal-foods"}),l=[];if(e.foods.length===0&&e.metadata.state!=="completed")Vr(i);else for(let d=0;d<e.foods.length;d++){let c=e.foods[d];if(!c)continue;let u=lt(i,c,d,r,e.metadata.state);l.push(u)}ct(o,e.metadata.state,r,e),o.addEventListener("focusout",d=>{let c=d.relatedTarget;(!c||!o.contains(c))&&r.onFlushChanges()})}function Vr(n){n.createDiv({cls:"meal-empty-state"}).createDiv({cls:"meal-empty-message",text:"\uC544\uC9C1 \uC74C\uC2DD\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. \uC544\uB798\uC5D0\uC11C \uC74C\uC2DD\uC744 \uCD94\uAC00\uD574\uC8FC\uC138\uC694."})}function Ur(n,t,e){var l;let r=t.match(/!\[\[([^\]]+)\]\]/);if(!r)return;let a=r[1];if(!a)return;let o=e.metadataCache.getFirstLinkpathDest(a,"");if(!o){(l=n.querySelector(".meal-photo-embed"))==null||l.setText(`\u{1F4F7} ${a} (\uC774\uBBF8\uC9C0\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC74C)`);return}let s=e.vault.getResourcePath(o),i=n.querySelector(".meal-photo");if(i){i.empty();let d=i.createEl("img",{cls:"meal-photo-image",attr:{src:s,alt:a}})}}var k=require("obsidian"),dt=[{name:"\uC218\uD559",icon:"",color:"#4A90D9"},{name:"\uC601\uC5B4",icon:"",color:"#7B68EE"},{name:"\uD504\uB85C\uADF8\uB798\uBC0D",icon:"",color:"#50C878"},{name:"\uB3C5\uC11C",icon:"",color:"#FFB347"},{name:"\uAE30\uD0C0",icon:"",color:"#A0A0A0"}],ke=[{name:"\uC0C1\uCCB4 \uC6B4\uB3D9",exercises:[{name:"\uD478\uC2DC\uC5C5",params:"\uD69F\uC218: [15]"},{name:"\uB364\uBCA8 \uB85C\uC6B0",params:"\uBB34\uAC8C: [10]kg | \uD69F\uC218: [12]"},{name:"\uC204\uB354 \uD504\uB808\uC2A4",params:"\uBB34\uAC8C: [8]kg | \uD69F\uC218: [10]"}]},{name:"\uD558\uCCB4 \uC6B4\uB3D9",exercises:[{name:"\uC2A4\uCFFC\uD2B8",params:"\uBB34\uAC8C: [40]kg | \uD69F\uC218: [12]"},{name:"\uB7F0\uC9C0",params:"\uD69F\uC218: [10] /\uB2E4\uB9AC"},{name:"\uCE74\uD504\uB808\uC774\uC988",params:"\uD69F\uC218: [20]"}]},{name:"HIIT",exercises:[{name:"\uBC84\uD53C",params:"\uC2DC\uAC04: [30\uCD08]"},{name:"\uC810\uD551\uC7AD",params:"\uC2DC\uAC04: [30\uCD08]"},{name:"\uB9C8\uC6B4\uD2F4 \uD074\uB77C\uC774\uBA38",params:"\uC2DC\uAC04: [30\uCD08]"}]}],X={defaultProvider:"openai",openaiApiKey:"",openaiModel:"gpt-5",geminiApiKey:"",geminiModel:"gemini-2.5-flash",grokApiKey:"",grokModel:"grok-4-1-fast",openRouterApiKey:"",openRouterModel:"anthropic/claude-sonnet-4",openRouterCustomModels:[],autoAnalysis:!1,analysisSchedule:"manual",enabledTemplates:["study-weekly","study-monthly","workout-weekly","workout-progress","work-weekly","work-productivity","meal-weekly","meal-pattern"],customTemplates:[],reportSavePath:"Life Logs/Reports",reportNaming:"{{category}}_{{date}}_report"},ut={logFolder:"Life Logs",dateFormat:"YYYY-MM-DD",subjects:dt,defaultStudyDuration:30,enablePomodoro:!1,pomodoroWork:25,pomodoroBreak:5,defaultRestDuration:60,workoutTemplates:ke,defaultTab:"study",showRibbonIcon:!0,enableTimerSound:!0,enableNotifications:!0,timerStyle:"digital",usePerTypeTimerStyle:!1,studyTimerStyle:"pomodoro",workTimerStyle:"digital",workoutTimerStyle:"digital",aiAnalysis:X},ye=class extends k.PluginSettingTab{constructor(t,e){super(t,e),this.plugin=e,console.log("[Life Log] LifeLogSettingTab constructed")}display(){console.log("[Life Log] LifeLogSettingTab.display() called");let{containerEl:t}=this;if(t.empty(),t.createEl("h2",{text:"Life Log \uC124\uC815"}),!this.plugin.settings){t.createEl("p",{text:"\uC124\uC815\uC744 \uBD88\uB7EC\uC624\uB294 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4."});return}this.plugin.settings.aiAnalysis||(this.plugin.settings.aiAnalysis={...X}),this.renderSaveSettings(t),this.renderStudySettings(t),this.renderWorkoutSettings(t),this.renderTimerStyleSettings(t),this.renderUISettings(t),this.renderNotificationSettings(t),this.renderAISettings(t)}renderSaveSettings(t){t.createEl("h3",{text:"\u{1F4C1} \uC800\uC7A5 \uC124\uC815"}),new k.Setting(t).setName("\uAE30\uB85D \uC800\uC7A5 \uD3F4\uB354").setDesc("\uD559\uC2B5/\uC6B4\uB3D9 \uAE30\uB85D\uC774 \uC800\uC7A5\uB420 \uD3F4\uB354 \uACBD\uB85C").addText(e=>e.setPlaceholder("Life Logs").setValue(this.plugin.settings.logFolder).onChange(async r=>{this.plugin.settings.logFolder=r||"Life Logs",await this.plugin.saveSettings()})),new k.Setting(t).setName("\uB0A0\uC9DC \uD615\uC2DD").setDesc("\uD30C\uC77C\uBA85\uC5D0 \uC0AC\uC6A9\uB420 \uB0A0\uC9DC \uD615\uC2DD").addDropdown(e=>e.addOption("YYYY-MM-DD","YYYY-MM-DD").addOption("YYYY/MM/DD","YYYY/MM/DD").addOption("DD-MM-YYYY","DD-MM-YYYY").setValue(this.plugin.settings.dateFormat).onChange(async r=>{this.plugin.settings.dateFormat=r,await this.plugin.saveSettings()}))}renderStudySettings(t){t.createEl("h3",{text:"\u{1F4DA} \uD559\uC2B5 \uAE30\uB85D \uC124\uC815"}),new k.Setting(t).setName("\uAE30\uBCF8 \uBAA9\uD45C \uC2DC\uAC04").setDesc("\uD559\uC2B5 \uD56D\uBAA9\uC758 \uAE30\uBCF8 \uBAA9\uD45C \uC2DC\uAC04 (\uBD84)").addText(e=>e.setPlaceholder("30").setValue(String(this.plugin.settings.defaultStudyDuration)).onChange(async r=>{let a=parseInt(r)||30;this.plugin.settings.defaultStudyDuration=Math.max(1,Math.min(480,a)),await this.plugin.saveSettings()})),new k.Setting(t).setName("\uD3EC\uBAA8\uB3C4\uB85C \uBAA8\uB4DC").setDesc("25\uBD84 \uD559\uC2B5 + 5\uBD84 \uD734\uC2DD \uC0AC\uC774\uD074 \uD65C\uC131\uD654").addToggle(e=>e.setValue(this.plugin.settings.enablePomodoro).onChange(async r=>{this.plugin.settings.enablePomodoro=r,await this.plugin.saveSettings()})),this.plugin.settings.enablePomodoro&&(new k.Setting(t).setName("\uC791\uC5C5 \uC2DC\uAC04").setDesc("\uD3EC\uBAA8\uB3C4\uB85C \uC791\uC5C5 \uC2DC\uAC04 (\uBD84)").addText(e=>e.setPlaceholder("25").setValue(String(this.plugin.settings.pomodoroWork)).onChange(async r=>{let a=parseInt(r)||25;this.plugin.settings.pomodoroWork=Math.max(1,Math.min(60,a)),await this.plugin.saveSettings()})),new k.Setting(t).setName("\uD734\uC2DD \uC2DC\uAC04").setDesc("\uD3EC\uBAA8\uB3C4\uB85C \uD734\uC2DD \uC2DC\uAC04 (\uBD84)").addText(e=>e.setPlaceholder("5").setValue(String(this.plugin.settings.pomodoroBreak)).onChange(async r=>{let a=parseInt(r)||5;this.plugin.settings.pomodoroBreak=Math.max(1,Math.min(30,a)),await this.plugin.saveSettings()}))),this.renderSubjectManager(t)}renderSubjectManager(t){let e=t.createDiv({cls:"subject-manager"});new k.Setting(e).setName("\uACFC\uBAA9 \uAD00\uB9AC").setDesc("\uC790\uC8FC \uC0AC\uC6A9\uD558\uB294 \uACFC\uBAA9\uC744 \uAD00\uB9AC\uD569\uB2C8\uB2E4").addButton(a=>a.setButtonText("+ \uACFC\uBAA9 \uCD94\uAC00").onClick(async()=>{this.plugin.settings.subjects.push({name:"\uC0C8 \uACFC\uBAA9",icon:"\u{1F4DA}",color:"#808080"}),await this.plugin.saveSettings(),this.display()}));let r=e.createDiv({cls:"subject-list"});for(let a=0;a<this.plugin.settings.subjects.length;a++){let o=this.plugin.settings.subjects[a];if(!o)continue;let s=r.createDiv({cls:"subject-row"}),i=s.createEl("input",{type:"text",value:o.icon,cls:"subject-icon-input"});i.maxLength=2,i.addEventListener("change",async()=>{o.icon=i.value||"\u{1F4DA}",await this.plugin.saveSettings()});let l=s.createEl("input",{type:"text",value:o.name,cls:"subject-name-input"});l.addEventListener("change",async()=>{o.name=l.value||"\uACFC\uBAA9",await this.plugin.saveSettings()});let d=s.createEl("input",{type:"color",value:o.color,cls:"subject-color-input"});d.addEventListener("change",async()=>{o.color=d.value,await this.plugin.saveSettings()}),s.createEl("button",{text:"\u{1F5D1}",cls:"subject-delete-btn"}).addEventListener("click",async()=>{this.plugin.settings.subjects.splice(a,1),await this.plugin.saveSettings(),this.display()})}}renderWorkoutSettings(t){t.createEl("h3",{text:"\uC6B4\uB3D9 \uAE30\uB85D \uC124\uC815"}),new k.Setting(t).setName("\uAE30\uBCF8 \uD734\uC2DD \uC2DC\uAC04").setDesc("\uC6B4\uB3D9 \uC138\uD2B8 \uC0AC\uC774 \uAE30\uBCF8 \uD734\uC2DD \uC2DC\uAC04 (\uCD08)").addText(e=>e.setPlaceholder("60").setValue(String(this.plugin.settings.defaultRestDuration)).onChange(async r=>{let a=parseInt(r)||60;this.plugin.settings.defaultRestDuration=Math.max(10,Math.min(300,a)),await this.plugin.saveSettings()})),this.renderWorkoutTemplateManager(t)}renderWorkoutTemplateManager(t){let e=t.createDiv({cls:"template-manager"});new k.Setting(e).setName("\uC6B4\uB3D9 \uD15C\uD50C\uB9BF \uAD00\uB9AC").setDesc("\uBE60\uB978 \uD15C\uD50C\uB9BF\uC5D0 \uD45C\uC2DC\uB418\uB294 \uC6B4\uB3D9 \uC138\uD2B8\uB97C \uAD00\uB9AC\uD569\uB2C8\uB2E4").addButton(a=>a.setButtonText("+ \uD15C\uD50C\uB9BF \uCD94\uAC00").onClick(async()=>{this.plugin.settings.workoutTemplates.push({name:"\uC0C8 \uD15C\uD50C\uB9BF",exercises:[{name:"\uC6B4\uB3D9\uBA85",params:"\uD69F\uC218: [10]"}]}),await this.plugin.saveSettings(),this.display()}));let r=e.createDiv({cls:"template-list"});this.plugin.settings.workoutTemplates||(this.plugin.settings.workoutTemplates=[...ke]);for(let a=0;a<this.plugin.settings.workoutTemplates.length;a++){let o=this.plugin.settings.workoutTemplates[a];if(!o)continue;let s=r.createDiv({cls:"template-item"}),i=s.createDiv({cls:"template-header-row"}),l=i.createEl("input",{type:"text",value:o.name,cls:"template-name-input"});l.addEventListener("change",async()=>{o.name=l.value||"\uD15C\uD50C\uB9BF",await this.plugin.saveSettings()}),i.createEl("button",{text:"\uC0AD\uC81C",cls:"template-delete-btn"}).addEventListener("click",async()=>{this.plugin.settings.workoutTemplates.splice(a,1),await this.plugin.saveSettings(),this.display()});let c=s.createDiv({cls:"template-exercise-list"});for(let p=0;p<o.exercises.length;p++){let m=o.exercises[p];if(!m)continue;let g=c.createDiv({cls:"template-exercise-row"}),h=g.createEl("input",{type:"text",value:m.name,placeholder:"\uC6B4\uB3D9\uBA85",cls:"template-exercise-name"});h.addEventListener("change",async()=>{m.name=h.value||"\uC6B4\uB3D9",await this.plugin.saveSettings()});let y=g.createEl("input",{type:"text",value:m.params,placeholder:"\uBB34\uAC8C: [60]kg | \uD69F\uC218: [10]",cls:"template-exercise-params"});y.addEventListener("change",async()=>{m.params=y.value||"",await this.plugin.saveSettings()}),g.createEl("button",{text:"\xD7",cls:"template-exercise-delete"}).addEventListener("click",async()=>{o.exercises.splice(p,1),await this.plugin.saveSettings(),this.display()})}s.createEl("button",{text:"+ \uC6B4\uB3D9 \uCD94\uAC00",cls:"template-add-exercise"}).addEventListener("click",async()=>{o.exercises.push({name:"\uC6B4\uB3D9\uBA85",params:"\uD69F\uC218: [10]"}),await this.plugin.saveSettings(),this.display()})}}renderTimerStyleSettings(t){t.createEl("h3",{text:"\uD0C0\uC774\uBA38 \uC2A4\uD0C0\uC77C"});let e=[{value:"digital",label:"\uB514\uC9C0\uD138 (00:00:00)"},{value:"pomodoro",label:"\uBF40\uBAA8\uB3C4\uB85C (25/5 \uC0AC\uC774\uD074)"},{value:"analog",label:"\uC544\uB0A0\uB85C\uADF8 (\uC6D0\uD615 \uC2DC\uACC4)"}];new k.Setting(t).setName("\uACF5\uD1B5 \uD0C0\uC774\uBA38 \uC2A4\uD0C0\uC77C").setDesc("\uBAA8\uB4E0 \uAE30\uB85D \uC720\uD615\uC5D0 \uC801\uC6A9\uB418\uB294 \uAE30\uBCF8 \uD0C0\uC774\uBA38 \uC2A4\uD0C0\uC77C").addDropdown(r=>{for(let a of e)r.addOption(a.value,a.label);r.setValue(this.plugin.settings.timerStyle).onChange(async a=>{this.plugin.settings.timerStyle=a,await this.plugin.saveSettings()})}),new k.Setting(t).setName("\uC720\uD615\uBCC4 \uAC1C\uBCC4 \uC124\uC815").setDesc("\uD559\uC2B5/\uC5C5\uBB34/\uC6B4\uB3D9 \uAE30\uB85D\uB9C8\uB2E4 \uB2E4\uB978 \uD0C0\uC774\uBA38 \uC2A4\uD0C0\uC77C \uC0AC\uC6A9").addToggle(r=>r.setValue(this.plugin.settings.usePerTypeTimerStyle).onChange(async a=>{this.plugin.settings.usePerTypeTimerStyle=a,await this.plugin.saveSettings(),this.display()})),this.plugin.settings.usePerTypeTimerStyle&&(new k.Setting(t).setName("\uD559\uC2B5 \uAE30\uB85D \uD0C0\uC774\uBA38").setDesc("\uD559\uC2B5 \uAE30\uB85D\uC5D0 \uC0AC\uC6A9\uD560 \uD0C0\uC774\uBA38 \uC2A4\uD0C0\uC77C").addDropdown(r=>{for(let a of e)r.addOption(a.value,a.label);r.setValue(this.plugin.settings.studyTimerStyle).onChange(async a=>{this.plugin.settings.studyTimerStyle=a,await this.plugin.saveSettings()})}),new k.Setting(t).setName("\uC5C5\uBB34 \uAE30\uB85D \uD0C0\uC774\uBA38").setDesc("\uC5C5\uBB34 \uAE30\uB85D\uC5D0 \uC0AC\uC6A9\uD560 \uD0C0\uC774\uBA38 \uC2A4\uD0C0\uC77C").addDropdown(r=>{for(let a of e)r.addOption(a.value,a.label);r.setValue(this.plugin.settings.workTimerStyle).onChange(async a=>{this.plugin.settings.workTimerStyle=a,await this.plugin.saveSettings()})}),new k.Setting(t).setName("\uC6B4\uB3D9 \uAE30\uB85D \uD0C0\uC774\uBA38").setDesc("\uC6B4\uB3D9 \uAE30\uB85D\uC5D0 \uC0AC\uC6A9\uD560 \uD0C0\uC774\uBA38 \uC2A4\uD0C0\uC77C").addDropdown(r=>{for(let a of e)r.addOption(a.value,a.label);r.setValue(this.plugin.settings.workoutTimerStyle).onChange(async a=>{this.plugin.settings.workoutTimerStyle=a,await this.plugin.saveSettings()})}))}renderUISettings(t){t.createEl("h3",{text:"UI \uC124\uC815"}),new k.Setting(t).setName("\uAE30\uBCF8 \uD0ED").setDesc("\uC0C8 \uAE30\uB85D \uBAA8\uB2EC\uC744 \uC5F4 \uB54C \uAE30\uBCF8\uC73C\uB85C \uC120\uD0DD\uB418\uB294 \uD0ED").addDropdown(e=>e.addOption("study","\uD559\uC2B5 \uAE30\uB85D").addOption("workout","\uC6B4\uB3D9 \uAE30\uB85D").setValue(this.plugin.settings.defaultTab).onChange(async r=>{this.plugin.settings.defaultTab=r,await this.plugin.saveSettings()})),new k.Setting(t).setName("\uB9AC\uBCF8 \uC544\uC774\uCF58").setDesc("\uC67C\uCABD \uC0AC\uC774\uB4DC\uBC14\uC5D0 \uBE60\uB978 \uC811\uADFC \uC544\uC774\uCF58 \uD45C\uC2DC").addToggle(e=>e.setValue(this.plugin.settings.showRibbonIcon).onChange(async r=>{this.plugin.settings.showRibbonIcon=r,await this.plugin.saveSettings(),this.plugin.updateRibbonIcon()}))}renderNotificationSettings(t){t.createEl("h3",{text:"\u{1F514} \uC54C\uB9BC \uC124\uC815"}),new k.Setting(t).setName("\uD0C0\uC774\uBA38 \uC644\uB8CC\uC74C").setDesc("\uCE74\uC6B4\uD2B8\uB2E4\uC6B4 \uC644\uB8CC \uC2DC \uC54C\uB9BC\uC74C \uC7AC\uC0DD").addToggle(e=>e.setValue(this.plugin.settings.enableTimerSound).onChange(async r=>{this.plugin.settings.enableTimerSound=r,await this.plugin.saveSettings()})),new k.Setting(t).setName("\uC2DC\uC2A4\uD15C \uC54C\uB9BC").setDesc("\uD0C0\uC774\uBA38 \uC644\uB8CC \uC2DC \uC2DC\uC2A4\uD15C \uC54C\uB9BC \uD45C\uC2DC").addToggle(e=>e.setValue(this.plugin.settings.enableNotifications).onChange(async r=>{this.plugin.settings.enableNotifications=r,await this.plugin.saveSettings()}))}renderAISettings(t){t.createEl("h3",{text:"\u{1F916} AI \uBD84\uC11D \uC124\uC815"});let e=this.plugin.settings.aiAnalysis;new k.Setting(t).setName("AI Provider").setDesc("\uBD84\uC11D\uC5D0 \uC0AC\uC6A9\uD560 AI \uC11C\uBE44\uC2A4\uB97C \uC120\uD0DD\uD569\uB2C8\uB2E4").addDropdown(r=>r.addOption("openai","OpenAI (GPT-4)").addOption("gemini","Google Gemini").addOption("grok","xAI Grok").addOption("openrouter","OpenRouter").setValue(e.defaultProvider).onChange(async a=>{e.defaultProvider=a,await this.plugin.saveSettings(),this.display()})),this.renderOpenAISettings(t,e),this.renderGeminiSettings(t,e),this.renderGrokSettings(t,e),this.renderOpenRouterSettings(t,e),this.renderReportSettings(t,e)}renderOpenAISettings(t,e){let r=e.defaultProvider==="openai",a=t.createDiv({cls:`ai-provider-section ${r?"active":"collapsed"}`});if(new k.Setting(a).setName("\u25B6 OpenAI \uC124\uC815").setDesc(r?"\uD604\uC7AC \uC0AC\uC6A9 \uC911":"\uD074\uB9AD\uD558\uC5EC \uD655\uC7A5").setClass("ai-provider-header").addButton(o=>o.setButtonText("\uC5F0\uACB0 \uD14C\uC2A4\uD2B8").setDisabled(!e.openaiApiKey).onClick(async()=>{await this.testOpenAIConnection(e)})),r||e.openaiApiKey){new k.Setting(a).setName("API Key").setDesc("OpenAI API \uD0A4").addText(i=>i.setPlaceholder("sk-...").setValue(e.openaiApiKey?"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022":"").onChange(async l=>{l&&!l.startsWith("\u2022\u2022")&&(e.openaiApiKey=l,await this.plugin.saveSettings(),this.display())}));let o=[{value:"gpt-5.2",label:"GPT-5.2 (\uCD5C\uC2E0)"},{value:"gpt-5",label:"GPT-5 (\uCD94\uCC9C)"},{value:"o4-mini",label:"o4-mini (\uCD94\uB860 \uCD5C\uC801\uD654)"},{value:"o3",label:"o3 (\uCD94\uB860 \uBAA8\uB378)"},{value:"gpt-4o",label:"GPT-4o"},{value:"gpt-4o-mini",label:"GPT-4o Mini (\uBE60\uB984)"},{value:"custom",label:"\uC9C1\uC811 \uC785\uB825..."}],s=!o.some(i=>i.value===e.openaiModel&&i.value!=="custom");new k.Setting(a).setName("\uBAA8\uB378").setDesc("\uC0AC\uC6A9\uD560 OpenAI \uBAA8\uB378").addDropdown(i=>{for(let l of o)i.addOption(l.value,l.label);i.setValue(s?"custom":e.openaiModel).onChange(async l=>{l==="custom"?this.display():(e.openaiModel=l,await this.plugin.saveSettings(),this.display())})}),(s||e.openaiModel==="custom")&&new k.Setting(a).setName("\uCEE4\uC2A4\uD140 \uBAA8\uB378\uBA85").setDesc("OpenAI \uBAA8\uB378 ID\uB97C \uC9C1\uC811 \uC785\uB825").addText(i=>i.setPlaceholder("gpt-5-turbo").setValue(s?e.openaiModel:"").onChange(async l=>{l&&(e.openaiModel=l,await this.plugin.saveSettings())}))}}renderGeminiSettings(t,e){let r=e.defaultProvider==="gemini",a=t.createDiv({cls:`ai-provider-section ${r?"active":"collapsed"}`});if(new k.Setting(a).setName("\u25B6 Google Gemini \uC124\uC815").setDesc(r?"\uD604\uC7AC \uC0AC\uC6A9 \uC911":"\uD074\uB9AD\uD558\uC5EC \uD655\uC7A5").setClass("ai-provider-header").addButton(o=>o.setButtonText("\uC5F0\uACB0 \uD14C\uC2A4\uD2B8").setDisabled(!e.geminiApiKey).onClick(async()=>{await this.testGeminiConnection(e)})),r||e.geminiApiKey){new k.Setting(a).setName("API Key").setDesc("Google AI Studio API \uD0A4").addText(i=>i.setPlaceholder("AIza...").setValue(e.geminiApiKey?"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022":"").onChange(async l=>{l&&!l.startsWith("\u2022\u2022")&&(e.geminiApiKey=l,await this.plugin.saveSettings(),this.display())}));let o=[{value:"gemini-3-pro-preview",label:"Gemini 3 Pro (\uCD5C\uC2E0)"},{value:"gemini-3-flash-preview",label:"Gemini 3 Flash (\uBE60\uB984)"},{value:"gemini-2.5-pro",label:"Gemini 2.5 Pro (\uCD94\uCC9C)"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash"},{value:"gemini-2.5-flash-lite",label:"Gemini 2.5 Flash Lite (\uACBD\uB7C9)"},{value:"custom",label:"\uC9C1\uC811 \uC785\uB825..."}],s=!o.some(i=>i.value===e.geminiModel&&i.value!=="custom");new k.Setting(a).setName("\uBAA8\uB378").setDesc("\uC0AC\uC6A9\uD560 Gemini \uBAA8\uB378").addDropdown(i=>{for(let l of o)i.addOption(l.value,l.label);i.setValue(s?"custom":e.geminiModel).onChange(async l=>{l==="custom"?this.display():(e.geminiModel=l,await this.plugin.saveSettings(),this.display())})}),(s||e.geminiModel==="custom")&&new k.Setting(a).setName("\uCEE4\uC2A4\uD140 \uBAA8\uB378\uBA85").setDesc("Gemini \uBAA8\uB378 ID\uB97C \uC9C1\uC811 \uC785\uB825").addText(i=>i.setPlaceholder("gemini-3-ultra").setValue(s?e.geminiModel:"").onChange(async l=>{l&&(e.geminiModel=l,await this.plugin.saveSettings())}))}}renderGrokSettings(t,e){let r=e.defaultProvider==="grok",a=t.createDiv({cls:`ai-provider-section ${r?"active":"collapsed"}`});if(new k.Setting(a).setName("\u25B6 xAI Grok \uC124\uC815").setDesc(r?"\uD604\uC7AC \uC0AC\uC6A9 \uC911":"\uD074\uB9AD\uD558\uC5EC \uD655\uC7A5").setClass("ai-provider-header").addButton(o=>o.setButtonText("\uC5F0\uACB0 \uD14C\uC2A4\uD2B8").setDisabled(!e.grokApiKey).onClick(async()=>{await this.testGrokConnection(e)})),r||e.grokApiKey){new k.Setting(a).setName("API Key").setDesc("xAI API \uD0A4").addText(i=>i.setPlaceholder("xai-...").setValue(e.grokApiKey?"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022":"").onChange(async l=>{l&&!l.startsWith("\u2022\u2022")&&(e.grokApiKey=l,await this.plugin.saveSettings(),this.display())}));let o=[{value:"grok-4-1-fast",label:"Grok 4.1 Fast (\uCD5C\uC2E0/\uBE60\uB984)"},{value:"grok-4-heavy",label:"Grok 4 Heavy (\uACE0\uC131\uB2A5)"},{value:"grok-4",label:"Grok 4 (\uCD94\uCC9C)"},{value:"grok-3",label:"Grok 3"},{value:"grok-3-mini",label:"Grok 3 Mini (\uACBD\uB7C9)"},{value:"custom",label:"\uC9C1\uC811 \uC785\uB825..."}],s=!o.some(i=>i.value===e.grokModel&&i.value!=="custom");new k.Setting(a).setName("\uBAA8\uB378").setDesc("\uC0AC\uC6A9\uD560 Grok \uBAA8\uB378").addDropdown(i=>{for(let l of o)i.addOption(l.value,l.label);i.setValue(s?"custom":e.grokModel).onChange(async l=>{l==="custom"?this.display():(e.grokModel=l,await this.plugin.saveSettings(),this.display())})}),(s||e.grokModel==="custom")&&new k.Setting(a).setName("\uCEE4\uC2A4\uD140 \uBAA8\uB378\uBA85").setDesc("Grok \uBAA8\uB378 ID\uB97C \uC9C1\uC811 \uC785\uB825").addText(i=>i.setPlaceholder("grok-5-preview").setValue(s?e.grokModel:"").onChange(async l=>{l&&(e.grokModel=l,await this.plugin.saveSettings())}))}}renderOpenRouterSettings(t,e){let r=e.defaultProvider==="openrouter",a=t.createDiv({cls:`ai-provider-section ${r?"active":"collapsed"}`});if(new k.Setting(a).setName("\u25B6 OpenRouter \uC124\uC815").setDesc(r?"\uD604\uC7AC \uC0AC\uC6A9 \uC911 - \uB2E4\uC591\uD55C \uBAA8\uB378 \uC120\uD0DD \uAC00\uB2A5":"\uD074\uB9AD\uD558\uC5EC \uD655\uC7A5").setClass("ai-provider-header").addButton(o=>o.setButtonText("\uC5F0\uACB0 \uD14C\uC2A4\uD2B8").setDisabled(!e.openRouterApiKey).onClick(async()=>{await this.testOpenRouterConnection(e)})),r||e.openRouterApiKey){new k.Setting(a).setName("API Key").setDesc("OpenRouter API \uD0A4").addText(l=>l.setPlaceholder("sk-or-...").setValue(e.openRouterApiKey?"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022":"").onChange(async d=>{d&&!d.startsWith("\u2022\u2022")&&(e.openRouterApiKey=d,await this.plugin.saveSettings(),this.display())})),new k.Setting(a).setName("\uAE30\uBCF8 \uBAA8\uB378").setDesc("\uC0AC\uC6A9\uD560 OpenRouter \uBAA8\uB378 ID (\uC608: anthropic/claude-sonnet-4)").addText(l=>l.setPlaceholder("anthropic/claude-sonnet-4").setValue(e.openRouterModel).onChange(async d=>{e.openRouterModel=d||"anthropic/claude-sonnet-4",await this.plugin.saveSettings()}));let o=a.createDiv({cls:"custom-models-section"});new k.Setting(o).setName("\uCD94\uAC00 \uBAA8\uB378 \uAD00\uB9AC").setDesc("\uC790\uC8FC \uC0AC\uC6A9\uD558\uB294 \uBAA8\uB378\uC744 \uCD94\uAC00\uD569\uB2C8\uB2E4").addButton(l=>l.setButtonText("+ \uBAA8\uB378 \uCD94\uAC00").onClick(async()=>{e.openRouterCustomModels.push(""),await this.plugin.saveSettings(),this.display()}));let s=["anthropic/claude-sonnet-4","anthropic/claude-opus-4","openai/gpt-5","openai/o3","google/gemini-2.5-pro","google/gemini-3-flash-preview","meta-llama/llama-4-maverick","deepseek/deepseek-r1","mistralai/mistral-large-2"],i=o.createDiv({cls:"model-list"});for(let l=0;l<e.openRouterCustomModels.length;l++){let d=i.createDiv({cls:"model-row"}),c=d.createEl("input",{type:"text",value:e.openRouterCustomModels[l],placeholder:"model/name",cls:"model-input"});c.addEventListener("change",async()=>{e.openRouterCustomModels[l]=c.value,await this.plugin.saveSettings()}),d.createEl("button",{text:"\xD7",cls:"model-delete-btn"}).addEventListener("click",async()=>{e.openRouterCustomModels.splice(l,1),await this.plugin.saveSettings(),this.display()})}new k.Setting(o).setName("\uCD94\uCC9C \uBAA8\uB378").setDesc("\uC790\uC8FC \uC0AC\uC6A9\uB418\uB294 \uBAA8\uB378 \uBAA9\uB85D").addDropdown(l=>{l.addOption("","-- \uC120\uD0DD\uD558\uC5EC \uCD94\uAC00 --");for(let d of s)e.openRouterCustomModels.includes(d)||l.addOption(d,d);l.onChange(async d=>{d&&(e.openRouterCustomModels.push(d),await this.plugin.saveSettings(),this.display())})})}}renderReportSettings(t,e){t.createEl("h4",{text:"\u{1F4CA} \uB9AC\uD3EC\uD2B8 \uC124\uC815"}),new k.Setting(t).setName("\uC800\uC7A5 \uACBD\uB85C").setDesc("AI \uBD84\uC11D \uB9AC\uD3EC\uD2B8\uAC00 \uC800\uC7A5\uB420 \uD3F4\uB354 \uACBD\uB85C").addText(r=>r.setPlaceholder("Life Logs/Reports").setValue(e.reportSavePath).onChange(async a=>{e.reportSavePath=a||"Life Logs/Reports",await this.plugin.saveSettings()})),new k.Setting(t).setName("\uD30C\uC77C\uBA85 \uD615\uC2DD").setDesc("\uB9AC\uD3EC\uD2B8 \uD30C\uC77C\uBA85 \uD615\uC2DD ({{category}}, {{date}} \uC0AC\uC6A9 \uAC00\uB2A5)").addText(r=>r.setPlaceholder("{{category}}_{{date}}_report").setValue(e.reportNaming).onChange(async a=>{e.reportNaming=a||"{{category}}_{{date}}_report",await this.plugin.saveSettings()})),new k.Setting(t).setName("\uC790\uB3D9 \uBD84\uC11D").setDesc("\uC790\uB3D9 \uBD84\uC11D \uC77C\uC815 \uC124\uC815").addDropdown(r=>r.addOption("manual","\uC218\uB3D9 \uC2E4\uD589\uB9CC").addOption("daily","\uB9E4\uC77C").addOption("weekly","\uB9E4\uC8FC").setValue(e.analysisSchedule).onChange(async a=>{e.analysisSchedule=a,e.autoAnalysis=a!=="manual",await this.plugin.saveSettings()}))}async testOpenAIConnection(t){var e;new k.Notice("OpenAI \uC5F0\uACB0 \uD14C\uC2A4\uD2B8 \uC911...");try{let r=await fetch("https://api.openai.com/v1/models",{headers:{Authorization:`Bearer ${t.openaiApiKey}`}});if(r.ok)new k.Notice("\u2705 OpenAI \uC5F0\uACB0 \uC131\uACF5!");else{let a=await r.json();new k.Notice(`\u274C OpenAI \uC5F0\uACB0 \uC2E4\uD328: ${((e=a.error)==null?void 0:e.message)||r.statusText}`)}}catch(r){new k.Notice(`\u274C OpenAI \uC5F0\uACB0 \uC2E4\uD328: ${r instanceof Error?r.message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958"}`)}}async testGeminiConnection(t){var e;new k.Notice("Gemini \uC5F0\uACB0 \uD14C\uC2A4\uD2B8 \uC911...");try{let r=await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${t.geminiApiKey}`);if(r.ok)new k.Notice("\u2705 Gemini \uC5F0\uACB0 \uC131\uACF5!");else{let a=await r.json();new k.Notice(`\u274C Gemini \uC5F0\uACB0 \uC2E4\uD328: ${((e=a.error)==null?void 0:e.message)||r.statusText}`)}}catch(r){new k.Notice(`\u274C Gemini \uC5F0\uACB0 \uC2E4\uD328: ${r instanceof Error?r.message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958"}`)}}async testGrokConnection(t){var e;new k.Notice("Grok \uC5F0\uACB0 \uD14C\uC2A4\uD2B8 \uC911...");try{let r=await fetch("https://api.x.ai/v1/models",{headers:{Authorization:`Bearer ${t.grokApiKey}`}});if(r.ok)new k.Notice("\u2705 Grok \uC5F0\uACB0 \uC131\uACF5!");else{let a=await r.json();new k.Notice(`\u274C Grok \uC5F0\uACB0 \uC2E4\uD328: ${((e=a.error)==null?void 0:e.message)||r.statusText}`)}}catch(r){new k.Notice(`\u274C Grok \uC5F0\uACB0 \uC2E4\uD328: ${r instanceof Error?r.message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958"}`)}}async testOpenRouterConnection(t){var e,r,a;new k.Notice("OpenRouter \uC5F0\uACB0 \uD14C\uC2A4\uD2B8 \uC911...");try{let o=await fetch("https://openrouter.ai/api/v1/auth/key",{headers:{Authorization:`Bearer ${t.openRouterApiKey}`}});if(o.ok){let s=await o.json();new k.Notice(`\u2705 OpenRouter \uC5F0\uACB0 \uC131\uACF5! (\uD06C\uB808\uB527: $${((r=(e=s.data)==null?void 0:e.limit_remaining)==null?void 0:r.toFixed(2))||"N/A"})`)}else{let s=await o.json();new k.Notice(`\u274C OpenRouter \uC5F0\uACB0 \uC2E4\uD328: ${((a=s.error)==null?void 0:a.message)||o.statusText}`)}}catch(o){new k.Notice(`\u274C OpenRouter \uC5F0\uACB0 \uC2E4\uD328: ${o instanceof Error?o.message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958"}`)}}};var zt=require("obsidian");var ve=class{constructor(t,e){this.selectedSubject=null;this.taskInputs=[];this.container=t,this.ctx=e}render(){this.container.empty(),this.container.addClass("study-log-tab"),this.renderSubjectSelector(),this.renderTaskInput(),this.renderCreateButton()}renderSubjectSelector(){var a;let t=this.container.createDiv({cls:"tab-section"});t.createEl("label",{text:"\uACFC\uBAA9 \uC120\uD0DD",cls:"tab-label"});let e=t.createDiv({cls:"subject-grid"});for(let o of this.ctx.settings.subjects){let s=e.createEl("button",{cls:`subject-btn ${((a=this.selectedSubject)==null?void 0:a.name)===o.name?"selected":""}`});s.style.setProperty("--subject-color",o.color),s.createSpan({text:o.name,cls:"subject-name"}),s.addEventListener("click",()=>{this.selectedSubject=o,e.querySelectorAll(".subject-btn").forEach(i=>{i.classList.remove("selected")}),s.classList.add("selected")})}let r=e.createEl("button",{cls:"subject-btn subject-btn-add"});r.createSpan({text:"+"}),r.createSpan({text:"\uC9C1\uC811 \uC785\uB825"}),r.addEventListener("click",()=>{this.showCustomSubjectInput(t)})}showCustomSubjectInput(t){if(t.querySelector(".custom-subject-input"))return;let r=t.createDiv({cls:"custom-subject-input"}),a=r.createEl("input",{type:"text",placeholder:"\uACFC\uBAA9\uBA85 \uC785\uB825..."});a.focus(),a.addEventListener("keydown",o=>{o.key==="Enter"&&a.value.trim()?(this.selectedSubject={name:a.value.trim(),icon:"",color:"#808080"},r.remove(),this.render()):o.key==="Escape"&&r.remove()})}renderTaskInput(){let t=this.container.createDiv({cls:"tab-section"});t.createEl("label",{text:"\uD559\uC2B5 \uD56D\uBAA9",cls:"tab-label"});let e=t.createDiv({cls:"task-input-list"});this.addTaskInputRow(e),t.createEl("button",{cls:"add-task-btn",text:"+ \uD56D\uBAA9 \uCD94\uAC00"}).addEventListener("click",()=>{this.addTaskInputRow(e)})}addTaskInputRow(t){let e=t.createDiv({cls:"task-input-row"}),r=e.createEl("input",{type:"text",placeholder:"\uD559\uC2B5 \uD56D\uBAA9 (\uC608: Chapter 3 \uBCF5\uC2B5)",cls:"task-name-input"});this.taskInputs.push(r);let a=e.createEl("input",{type:"text",placeholder:"\uBAA9\uD45C \uC2DC\uAC04 (\uC608: 30m)",cls:"task-duration-input"});a.value=`${this.ctx.settings.defaultStudyDuration}m`,e.createEl("button",{cls:"task-remove-btn",text:"\xD7"}).addEventListener("click",()=>{let s=this.taskInputs.indexOf(r);s>-1&&this.taskInputs.splice(s,1),e.remove()}),r.focus()}renderCreateButton(){this.container.createDiv({cls:"tab-section tab-actions"}).createEl("button",{cls:"create-btn primary",text:"\uD559\uC2B5 \uAE30\uB85D \uC0DD\uC131"}).addEventListener("click",()=>this.createStudyLog())}async createStudyLog(){if(!this.selectedSubject)return;let t=this.collectTasks();if(t.length===0)return;let e=this.buildCodeBlockContent(t),r=await this.ctx.fileCreator.createLogFile("study",e);this.ctx.onCreated(r)}collectTasks(){let t=[];return this.container.querySelectorAll(".task-input-row").forEach(r=>{let a=r.querySelector(".task-name-input"),o=r.querySelector(".task-duration-input");a!=null&&a.value.trim()&&t.push({name:a.value.trim(),duration:(o==null?void 0:o.value.trim())||`${this.ctx.settings.defaultStudyDuration}m`})}),t}buildCodeBlockContent(t){var s;let e=[],a=new Date().getHours(),o=a<12?"\uC624\uC804":a<18?"\uC624\uD6C4":"\uC800\uB141";e.push(`title: ${o} \uD559\uC2B5`),e.push(`subject: ${((s=this.selectedSubject)==null?void 0:s.name)||"\uAE30\uD0C0"}`),e.push("state: planned"),e.push("---");for(let i of t)e.push(`- [ ] ${i.name} | Duration: [${i.duration}]`);return e.join(`
`)}};var qr={high:"#E74C3C",medium:"#F39C12",low:"#3498DB"},Se=class{constructor(t,e){this.container=t,this.ctx=e}render(){this.container.empty(),this.container.addClass("work-log-tab"),this.renderTitleInput(),this.renderTaskInput(),this.renderCreateButton()}renderTitleInput(){let t=this.container.createDiv({cls:"tab-section"});t.createEl("label",{text:"\uC5C5\uBB34 \uC81C\uBAA9",cls:"tab-label"});let e=t.createEl("input",{type:"text",placeholder:"\uC608: \uC624\uC804 \uC5C5\uBB34, \uD504\uB85C\uC81D\uD2B8 A",cls:"work-title-input"}),a=new Date().getHours(),o=a<12?"\uC624\uC804":a<18?"\uC624\uD6C4":"\uC800\uB141";e.value=`${o} \uC5C5\uBB34`}renderTaskInput(){let t=this.container.createDiv({cls:"tab-section"});t.createEl("label",{text:"\uC5C5\uBB34 \uD56D\uBAA9",cls:"tab-label"});let e=t.createDiv({cls:"work-task-input-list"});this.addTaskInputRow(e),t.createEl("button",{cls:"add-task-btn",text:"+ \uC5C5\uBB34 \uCD94\uAC00"}).addEventListener("click",()=>{this.addTaskInputRow(e)})}addTaskInputRow(t){let e=t.createDiv({cls:"work-task-input-row"}),r=e.createEl("input",{type:"text",placeholder:"\uC5C5\uBB34 \uB0B4\uC6A9 (\uC608: \uAE30\uD68D\uC11C \uC791\uC131)",cls:"work-task-name-input"}),a=e.createEl("select",{cls:"work-task-priority-select"}),o=[{value:"high",label:"\uB192\uC74C"},{value:"medium",label:"\uBCF4\uD1B5"},{value:"low",label:"\uB0AE\uC74C"}];for(let l of o){let d=a.createEl("option",{value:l.value,text:l.label});l.value==="medium"&&(d.selected=!0)}a.addEventListener("change",()=>{let l=qr[a.value];a.style.borderColor=l});let s=e.createEl("input",{type:"text",placeholder:"\uC608\uC0C1 \uC2DC\uAC04 (\uC608: 2h)",cls:"work-task-duration-input"});s.value="1h",e.createEl("button",{cls:"work-task-remove-btn",text:"\xD7"}).addEventListener("click",()=>{e.remove()}),r.focus()}renderCreateButton(){this.container.createDiv({cls:"tab-section tab-actions"}).createEl("button",{cls:"create-btn primary",text:"\uC5C5\uBB34 \uAE30\uB85D \uC0DD\uC131"}).addEventListener("click",()=>this.createWorkLog())}async createWorkLog(){let t=this.collectTasks();if(t.length===0)return;let e=this.container.querySelector(".work-title-input"),r=(e==null?void 0:e.value.trim())||"\uC5C5\uBB34",a=this.buildCodeBlockContent(r,t),o=await this.ctx.fileCreator.createLogFile("work",a);this.ctx.onCreated(o)}collectTasks(){let t=[];return this.container.querySelectorAll(".work-task-input-row").forEach(r=>{let a=r.querySelector(".work-task-name-input"),o=r.querySelector(".work-task-priority-select"),s=r.querySelector(".work-task-duration-input");a!=null&&a.value.trim()&&t.push({name:a.value.trim(),priority:(o==null?void 0:o.value)||"medium",expectedDuration:(s==null?void 0:s.value.trim())||"1h"})}),t}buildCodeBlockContent(t,e){let r=[];r.push(`title: ${t}`),r.push("state: planned"),r.push("---");for(let a of e)r.push(`- [ ] ${a.name} | Priority: ${a.priority} | Expected: [${a.expectedDuration}]`);return r.join(`
`)}};var Te=class{constructor(t,e){this.exerciseInputs=[];this.container=t,this.ctx=e}render(){this.container.empty(),this.container.addClass("workout-log-tab"),this.renderTitleInput(),this.renderExerciseInput(),this.renderQuickTemplates(),this.renderCreateButton()}renderTitleInput(){let t=this.container.createDiv({cls:"tab-section"});t.createEl("label",{text:"\uC6B4\uB3D9 \uC774\uB984",cls:"tab-label"});let e=t.createEl("input",{type:"text",placeholder:"\uC608: \uC544\uCE68 \uC6B4\uB3D9, \uC0C1\uCCB4 \uC6B4\uB3D9",cls:"workout-title-input"}),a=new Date().getHours(),o=a<12?"\uC544\uCE68":a<18?"\uC624\uD6C4":"\uC800\uB141";e.value=`${o} \uC6B4\uB3D9`}renderExerciseInput(){let t=this.container.createDiv({cls:"tab-section"});t.createEl("label",{text:"\uC6B4\uB3D9 \uD56D\uBAA9",cls:"tab-label"});let e=t.createDiv({cls:"exercise-input-list"});this.addExerciseInputRow(e),t.createEl("button",{cls:"add-exercise-btn",text:"+ \uC6B4\uB3D9 \uCD94\uAC00"}).addEventListener("click",()=>{this.addExerciseInputRow(e)})}addExerciseInputRow(t){let e=t.createDiv({cls:"exercise-input-row"}),r=e.createEl("input",{type:"text",placeholder:"\uC6B4\uB3D9\uBA85 (\uC608: \uC2A4\uCFFC\uD2B8)",cls:"exercise-name-input"}),a=e.createEl("input",{type:"text",placeholder:"\uBB34\uAC8C: [60]kg | \uD69F\uC218: [10]",cls:"exercise-params-input"});e.createEl("button",{cls:"exercise-remove-btn",text:"\xD7"}).addEventListener("click",()=>{e.remove()}),r.focus()}renderQuickTemplates(){var o;let t=this.container.createDiv({cls:"tab-section"});t.createEl("label",{text:"\uBE60\uB978 \uD15C\uD50C\uB9BF",cls:"tab-label"});let e=t.createDiv({cls:"template-grid"}),r=[{name:"\uC0C1\uCCB4 \uC6B4\uB3D9",exercises:[{name:"\uD478\uC2DC\uC5C5",params:"\uD69F\uC218: [15]"},{name:"\uB364\uBCA8 \uB85C\uC6B0",params:"\uBB34\uAC8C: [10]kg | \uD69F\uC218: [12]"},{name:"\uC204\uB354 \uD504\uB808\uC2A4",params:"\uBB34\uAC8C: [8]kg | \uD69F\uC218: [10]"}]},{name:"\uD558\uCCB4 \uC6B4\uB3D9",exercises:[{name:"\uC2A4\uCFFC\uD2B8",params:"\uBB34\uAC8C: [40]kg | \uD69F\uC218: [12]"},{name:"\uB7F0\uC9C0",params:"\uD69F\uC218: [10] /\uB2E4\uB9AC"},{name:"\uCE74\uD504\uB808\uC774\uC988",params:"\uD69F\uC218: [20]"}]},{name:"HIIT",exercises:[{name:"\uBC84\uD53C",params:"\uC2DC\uAC04: [30\uCD08]"},{name:"\uC810\uD551\uC7AD",params:"\uC2DC\uAC04: [30\uCD08]"},{name:"\uB9C8\uC6B4\uD2F4 \uD074\uB77C\uC774\uBA38",params:"\uC2DC\uAC04: [30\uCD08]"}]}],a=((o=this.ctx.settings.workoutTemplates)==null?void 0:o.length)>0?this.ctx.settings.workoutTemplates:r;for(let s of a){let i=e.createEl("button",{cls:"template-btn"});i.createSpan({text:s.name}),i.addEventListener("click",()=>{this.applyTemplate(s)})}}applyTemplate(t){let e=this.container.querySelector(".workout-title-input");e&&(e.value=t.name);let r=this.container.querySelector(".exercise-input-list");if(r){r.empty();for(let a of t.exercises)this.addExerciseInputRowWithData(r,a)}}addExerciseInputRowWithData(t,e){let r=t.createDiv({cls:"exercise-input-row"}),a=r.createEl("input",{type:"text",placeholder:"\uC6B4\uB3D9\uBA85",cls:"exercise-name-input"});a.value=e.name;let o=r.createEl("input",{type:"text",placeholder:"\uD30C\uB77C\uBBF8\uD130",cls:"exercise-params-input"});o.value=e.params,r.createEl("button",{cls:"exercise-remove-btn",text:"\xD7"}).addEventListener("click",()=>{r.remove()})}renderCreateButton(){this.container.createDiv({cls:"tab-section tab-actions"}).createEl("button",{cls:"create-btn primary",text:"\uC6B4\uB3D9 \uAE30\uB85D \uC0DD\uC131"}).addEventListener("click",()=>this.createWorkoutLog())}async createWorkoutLog(){let t=this.collectExercises();if(t.length===0)return;let e=this.container.querySelector(".workout-title-input"),r=(e==null?void 0:e.value.trim())||"\uC6B4\uB3D9",a=this.buildCodeBlockContent(r,t),o=await this.ctx.fileCreator.createLogFile("workout",a);this.ctx.onCreated(o)}collectExercises(){let t=[];return this.container.querySelectorAll(".exercise-input-row").forEach(r=>{let a=r.querySelector(".exercise-name-input"),o=r.querySelector(".exercise-params-input");a!=null&&a.value.trim()&&t.push({name:a.value.trim(),params:(o==null?void 0:o.value.trim())||""})}),t}buildCodeBlockContent(t,e){let r=[];r.push(`title: ${t}`),r.push("state: planned"),r.push("startDate:"),r.push("duration:"),r.push(`restDuration: ${this.ctx.settings.defaultRestDuration}s`),r.push("---");for(let a of e)a.params?r.push(`- [ ] ${a.name} | ${a.params}`):r.push(`- [ ] ${a.name}`);return r.join(`
`)}};var B=class extends zt.Modal{constructor(e,r,a){super(e);this.tabContentEl=null;this.settings=r,this.fileCreator=a,this.activeTab=r.defaultTab}onOpen(){let{contentEl:e}=this;e.empty(),e.addClass("quick-log-modal"),this.renderHeader(e),this.renderTabs(e),this.renderTabContent(e)}renderHeader(e){e.createDiv({cls:"modal-header"}).createEl("h2",{text:"Life Log"})}renderTabs(e){let r=e.createDiv({cls:"modal-tabs"});r.createEl("button",{cls:`modal-tab ${this.activeTab==="study"?"active":""}`,text:"\uD559\uC2B5 \uAE30\uB85D"}).addEventListener("click",()=>{this.activeTab="study",this.updateActiveTab(r),this.renderTabContent(e)}),r.createEl("button",{cls:`modal-tab ${this.activeTab==="work"?"active":""}`,text:"\uC5C5\uBB34 \uAE30\uB85D"}).addEventListener("click",()=>{this.activeTab="work",this.updateActiveTab(r),this.renderTabContent(e)}),r.createEl("button",{cls:`modal-tab ${this.activeTab==="workout"?"active":""}`,text:"\uC6B4\uB3D9 \uAE30\uB85D"}).addEventListener("click",()=>{this.activeTab="workout",this.updateActiveTab(r),this.renderTabContent(e)})}updateActiveTab(e){let r=["study","work","workout"];e.querySelectorAll(".modal-tab").forEach((a,o)=>{r[o]===this.activeTab?a.classList.add("active"):a.classList.remove("active")})}renderTabContent(e){this.tabContentEl&&this.tabContentEl.remove(),this.tabContentEl=e.createDiv({cls:"modal-tab-content"});let r=a=>{this.close(),this.app.workspace.getLeaf().openFile(a)};this.activeTab==="study"?new ve(this.tabContentEl,{app:this.app,settings:this.settings,fileCreator:this.fileCreator,onCreated:r}).render():this.activeTab==="work"?new Se(this.tabContentEl,{app:this.app,settings:this.settings,fileCreator:this.fileCreator,onCreated:r}).render():new Te(this.tabContentEl,{app:this.app,settings:this.settings,fileCreator:this.fileCreator,onCreated:r}).render()}onClose(){let{contentEl:e}=this;e.empty()}};var _t=require("obsidian"),be=class extends _t.Modal{constructor(e,r){super(e);this.focusScore=4;this.comprehensionScore=4;this.notes="";this.onSubmit=r}onOpen(){let{contentEl:e}=this;e.empty(),e.addClass("self-eval-modal"),e.createEl("h2",{text:"\u{1F389} \uD559\uC2B5 \uC644\uB8CC! \uC790\uAC00\uD3C9\uAC00\uB97C \uD574\uC8FC\uC138\uC694"}),this.renderFocusScore(e),this.renderComprehensionScore(e),this.renderNotesInput(e),this.renderButtons(e)}renderFocusScore(e){let r=e.createDiv({cls:"eval-section"});r.createEl("label",{text:"\uC9D1\uC911\uB3C4",cls:"eval-label"});let a=r.createDiv({cls:"eval-stars"});this.renderStarPicker(a,this.focusScore,o=>{this.focusScore=o})}renderComprehensionScore(e){let r=e.createDiv({cls:"eval-section"});r.createEl("label",{text:"\uC774\uD574\uB3C4",cls:"eval-label"});let a=r.createDiv({cls:"eval-stars"});this.renderStarPicker(a,this.comprehensionScore,o=>{this.comprehensionScore=o})}renderStarPicker(e,r,a){for(let o=1;o<=5;o++){let s=e.createSpan({cls:`eval-star ${o<=r?"filled":""}`,text:o<=r?"\u2605":"\u2606"});s.addEventListener("click",()=>{a(o),e.querySelectorAll(".eval-star").forEach((i,l)=>{let d=i;l<o?(d.textContent="\u2605",d.classList.add("filled")):(d.textContent="\u2606",d.classList.remove("filled"))})}),s.addEventListener("mouseenter",()=>{e.querySelectorAll(".eval-star").forEach((i,l)=>{let d=i;l<o&&d.classList.add("hover")})}),s.addEventListener("mouseleave",()=>{e.querySelectorAll(".eval-star").forEach(i=>{i.classList.remove("hover")})})}}renderNotesInput(e){let r=e.createDiv({cls:"eval-section"});r.createEl("label",{text:"\uBA54\uBAA8 (\uC120\uD0DD)",cls:"eval-label"});let a=r.createEl("textarea",{cls:"eval-notes-input",placeholder:"\uC624\uB298 \uD559\uC2B5\uC5D0 \uB300\uD55C \uC9E7\uC740 \uBA54\uBAA8..."});a.rows=3,a.addEventListener("input",()=>{this.notes=a.value})}renderButtons(e){let r=e.createDiv({cls:"eval-buttons"});r.createEl("button",{cls:"eval-btn eval-btn-secondary",text:"\uCDE8\uC18C"}).addEventListener("click",()=>this.close()),r.createEl("button",{cls:"eval-btn eval-btn-primary",text:"\uC800\uC7A5\uD558\uACE0 \uC885\uB8CC"}).addEventListener("click",()=>{this.onSubmit({focusScore:this.focusScore,comprehensionScore:this.comprehensionScore,notes:this.notes||void 0}),this.close()})}onClose(){let{contentEl:e}=this;e.empty()}};var E=require("obsidian");var pt=[{id:"study-weekly",name:"\uC8FC\uAC04 \uD559\uC2B5 \uB9AC\uD3EC\uD2B8",category:"study",description:"\uC77C\uC8FC\uC77C\uAC04\uC758 \uD559\uC2B5 \uD328\uD134\uACFC \uC131\uACFC\uB97C \uBD84\uC11D\uD569\uB2C8\uB2E4.",isBuiltIn:!0,isEnabled:!0,systemPrompt:`\uB2F9\uC2E0\uC740 \uD559\uC2B5 \uD6A8\uC728 \uBD84\uC11D \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4. \uD559\uC0DD\uC758 \uD559\uC2B5 \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uD6A8\uACFC\uC801\uC778 \uD559\uC2B5 \uC804\uB7B5\uC744 \uC81C\uC548\uD569\uB2C8\uB2E4.
\uBD84\uC11D \uC2DC \uB2E4\uC74C\uC744 \uACE0\uB824\uD558\uC138\uC694:
- \uACFC\uBAA9\uBCC4 \uD559\uC2B5 \uC2DC\uAC04 \uBD84\uD3EC
- \uC9D1\uC911\uB825\uACFC \uD6A8\uC728\uC131 \uD328\uD134
- \uAC15\uC810\uACFC \uAC1C\uC120\uC774 \uD544\uC694\uD55C \uC601\uC5ED
- \uAD6C\uCCB4\uC801\uC774\uACE0 \uC2E4\uD589 \uAC00\uB2A5\uD55C \uC870\uC5B8`,userPromptTemplate:`\uB2E4\uC74C \uD559\uC2B5 \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uC8FC\uAC04 \uD559\uC2B5 \uB9AC\uD3EC\uD2B8\uB97C \uC791\uC131\uD574\uC8FC\uC138\uC694.

[\uBD84\uC11D \uAE30\uAC04]
{{period}}

[\uD559\uC2B5 \uB370\uC774\uD130]
{{rawData}}

[\uC694\uCCAD\uC0AC\uD56D]
1. \uD559\uC2B5 \uC2DC\uAC04 \uC694\uC57D (\uCD1D \uC2DC\uAC04, \uC77C\uD3C9\uADE0, \uACFC\uBAA9\uBCC4)
2. \uD559\uC2B5 \uD328\uD134 \uBD84\uC11D (\uC2DC\uAC04\uB300\uBCC4 \uC9D1\uC911\uB3C4, \uD6A8\uC728\uC801\uC778 \uD559\uC2B5 \uC2DC\uAC04)
3. \uACFC\uBAA9\uBCC4 \uC2EC\uCE35 \uBD84\uC11D
4. \uAC15\uC810 \uBC0F \uAC1C\uC120\uC810
5. \uB2E4\uC74C \uC8FC \uCD94\uCC9C \uD559\uC2B5 \uACC4\uD68D

Markdown \uD615\uC2DD\uC73C\uB85C \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD574\uC8FC\uC138\uC694.`,dataRange:"week",outputFormat:"markdown",outputSections:["\uC694\uC57D","\uD559\uC2B5 \uC2DC\uAC04 \uBD84\uC11D","\uACFC\uBAA9\uBCC4 \uBD84\uC11D","\uAC15\uC810","\uAC1C\uC120\uC810","\uCD94\uCC9C \uACC4\uD68D"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0},{id:"study-monthly",name:"\uC6D4\uAC04 \uD559\uC2B5 \uB9AC\uD3EC\uD2B8",category:"study",description:"\uD55C \uB2EC\uAC04\uC758 \uD559\uC2B5 \uC131\uACFC\uC640 \uC131\uC7A5\uC744 \uBD84\uC11D\uD569\uB2C8\uB2E4.",isBuiltIn:!0,isEnabled:!0,systemPrompt:"\uB2F9\uC2E0\uC740 \uD559\uC2B5 \uBD84\uC11D \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4. \uC6D4\uAC04 \uD559\uC2B5 \uB370\uC774\uD130\uB97C \uBD84\uC11D\uD558\uC5EC \uC7A5\uAE30\uC801\uC778 \uC131\uC7A5 \uD2B8\uB80C\uB4DC\uC640 \uBAA9\uD45C \uB2EC\uC131\uB960\uC744 \uD3C9\uAC00\uD569\uB2C8\uB2E4.",userPromptTemplate:`\uB2E4\uC74C \uD559\uC2B5 \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uC6D4\uAC04 \uD559\uC2B5 \uB9AC\uD3EC\uD2B8\uB97C \uC791\uC131\uD574\uC8FC\uC138\uC694.

[\uBD84\uC11D \uAE30\uAC04]
{{period}}

[\uD559\uC2B5 \uB370\uC774\uD130]
{{rawData}}

[\uC694\uCCAD\uC0AC\uD56D]
1. \uC6D4\uAC04 \uD559\uC2B5 \uC694\uC57D (\uCD1D \uC2DC\uAC04, \uC8FC\uBCC4 \uCD94\uC774)
2. \uBAA9\uD45C \uB2EC\uC131\uB960 \uBD84\uC11D
3. \uC8FC\uBCC4 \uD2B8\uB80C\uB4DC \uBCC0\uD654
4. \uACFC\uBAA9\uBCC4 \uC131\uC7A5 \uBD84\uC11D
5. \uB2E4\uC74C \uB2EC \uBAA9\uD45C \uC81C\uC548

Markdown \uD615\uC2DD\uC73C\uB85C \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD574\uC8FC\uC138\uC694.`,dataRange:"month",outputFormat:"markdown",outputSections:["\uC6D4\uAC04 \uC694\uC57D","\uBAA9\uD45C \uB2EC\uC131\uB960","\uD2B8\uB80C\uB4DC \uBD84\uC11D","\uC131\uC7A5 \uBD84\uC11D","\uB2E4\uC74C \uB2EC \uBAA9\uD45C"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0},{id:"study-subject",name:"\uACFC\uBAA9\uBCC4 \uC2EC\uCE35 \uBD84\uC11D",category:"study",description:"\uD2B9\uC815 \uACFC\uBAA9\uC758 \uD559\uC2B5 \uD328\uD134\uACFC \uD6A8\uC728\uC131\uC744 \uBD84\uC11D\uD569\uB2C8\uB2E4.",isBuiltIn:!0,isEnabled:!0,systemPrompt:"\uB2F9\uC2E0\uC740 \uACFC\uBAA9\uBCC4 \uD559\uC2B5 \uBD84\uC11D \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4. \uD2B9\uC815 \uACFC\uBAA9\uC5D0 \uB300\uD55C \uAE4A\uC774 \uC788\uB294 \uBD84\uC11D\uACFC \uB9DE\uCDA4\uD615 \uD559\uC2B5 \uC804\uB7B5\uC744 \uC81C\uACF5\uD569\uB2C8\uB2E4.",userPromptTemplate:`\uB2E4\uC74C \uD559\uC2B5 \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uACFC\uBAA9\uBCC4 \uC2EC\uCE35 \uBD84\uC11D \uB9AC\uD3EC\uD2B8\uB97C \uC791\uC131\uD574\uC8FC\uC138\uC694.

[\uBD84\uC11D \uAE30\uAC04]
{{period}}

[\uD559\uC2B5 \uB370\uC774\uD130]
{{rawData}}

[\uC694\uCCAD\uC0AC\uD56D]
1. \uACFC\uBAA9\uBCC4 \uD559\uC2B5 \uC2DC\uAC04 \uBC0F \uBE48\uB3C4
2. \uAC01 \uACFC\uBAA9\uC758 \uD559\uC2B5 \uD6A8\uC728\uC131 \uD3C9\uAC00
3. \uACFC\uBAA9 \uAC04 \uADE0\uD615 \uBD84\uC11D
4. \uCDE8\uC57D \uACFC\uBAA9 \uC2DD\uBCC4 \uBC0F \uAC1C\uC120 \uBC29\uC548
5. \uACFC\uBAA9\uBCC4 \uB9DE\uCDA4 \uD559\uC2B5 \uC804\uB7B5

Markdown \uD615\uC2DD\uC73C\uB85C \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD574\uC8FC\uC138\uC694.`,dataRange:"month",outputFormat:"markdown",outputSections:["\uACFC\uBAA9\uBCC4 \uC694\uC57D","\uD6A8\uC728\uC131 \uBD84\uC11D","\uADE0\uD615 \uBD84\uC11D","\uAC1C\uC120 \uBC29\uC548","\uB9DE\uCDA4 \uC804\uB7B5"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0}],mt=[{id:"workout-weekly",name:"\uC8FC\uAC04 \uC6B4\uB3D9 \uB9AC\uD3EC\uD2B8",category:"workout",description:"\uC77C\uC8FC\uC77C\uAC04\uC758 \uC6B4\uB3D9 \uAE30\uB85D\uC744 \uBD84\uC11D\uD569\uB2C8\uB2E4.",isBuiltIn:!0,isEnabled:!0,systemPrompt:"\uB2F9\uC2E0\uC740 \uD53C\uD2B8\uB2C8\uC2A4 \uBD84\uC11D \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4. \uC6B4\uB3D9 \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uD6A8\uACFC\uC801\uC778 \uD2B8\uB808\uC774\uB2DD \uC804\uB7B5\uC744 \uC81C\uC548\uD569\uB2C8\uB2E4.",userPromptTemplate:`\uB2E4\uC74C \uC6B4\uB3D9 \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uC8FC\uAC04 \uC6B4\uB3D9 \uB9AC\uD3EC\uD2B8\uB97C \uC791\uC131\uD574\uC8FC\uC138\uC694.

[\uBD84\uC11D \uAE30\uAC04]
{{period}}

[\uC6B4\uB3D9 \uB370\uC774\uD130]
{{rawData}}

[\uC694\uCCAD\uC0AC\uD56D]
1. \uC8FC\uAC04 \uC6B4\uB3D9 \uC694\uC57D (\uCD1D \uC6B4\uB3D9 \uC2DC\uAC04, \uD69F\uC218)
2. \uC6B4\uB3D9 \uC720\uD615\uBCC4 \uBD84\uC11D
3. \uC6B4\uB3D9 \uAC15\uB3C4 \uBC0F \uBCFC\uB968 \uBD84\uC11D
4. \uD734\uC2DD \uD328\uD134 \uD3C9\uAC00
5. \uB2E4\uC74C \uC8FC \uC6B4\uB3D9 \uCD94\uCC9C

Markdown \uD615\uC2DD\uC73C\uB85C \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD574\uC8FC\uC138\uC694.`,dataRange:"week",outputFormat:"markdown",outputSections:["\uC8FC\uAC04 \uC694\uC57D","\uC6B4\uB3D9 \uBD84\uC11D","\uAC15\uB3C4 \uBD84\uC11D","\uD734\uC2DD \uBD84\uC11D","\uCD94\uCC9C \uACC4\uD68D"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0},{id:"workout-progress",name:"\uC9C4\uCC99\uB3C4 \uBD84\uC11D",category:"workout",description:"\uC6B4\uB3D9 \uC9C4\uD589 \uC0C1\uD669\uACFC \uC131\uACFC\uB97C \uBD84\uC11D\uD569\uB2C8\uB2E4.",isBuiltIn:!0,isEnabled:!0,systemPrompt:"\uB2F9\uC2E0\uC740 \uC6B4\uB3D9 \uC131\uACFC \uBD84\uC11D \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4. \uC6B4\uB3D9 \uAE30\uB85D\uC758 \uC9C4\uCC99\uB3C4\uB97C \uBD84\uC11D\uD558\uC5EC \uC131\uC7A5 \uD2B8\uB80C\uB4DC\uC640 \uAC1C\uC120\uC810\uC744 \uC81C\uC2DC\uD569\uB2C8\uB2E4.",userPromptTemplate:`\uB2E4\uC74C \uC6B4\uB3D9 \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uC9C4\uCC99\uB3C4 \uB9AC\uD3EC\uD2B8\uB97C \uC791\uC131\uD574\uC8FC\uC138\uC694.

[\uBD84\uC11D \uAE30\uAC04]
{{period}}

[\uC6B4\uB3D9 \uB370\uC774\uD130]
{{rawData}}

[\uC694\uCCAD\uC0AC\uD56D]
1. \uC804\uBC18\uC801\uC778 \uC9C4\uCC99\uB3C4 \uD3C9\uAC00
2. \uC6B4\uB3D9\uBCC4 \uC131\uACFC \uBCC0\uD654 \uCD94\uC774
3. \uAC1C\uC778 \uAE30\uB85D \uB2EC\uC131 \uD604\uD669
4. \uADFC\uC721 \uADF8\uB8F9\uBCC4 \uBC1C\uB2EC \uC0C1\uD0DC
5. \uD5A5\uD6C4 \uBAA9\uD45C \uBC0F \uC870\uC5B8

Markdown \uD615\uC2DD\uC73C\uB85C \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD574\uC8FC\uC138\uC694.`,dataRange:"month",outputFormat:"markdown",outputSections:["\uC9C4\uCC99\uB3C4 \uC694\uC57D","\uC131\uACFC \uCD94\uC774","\uAE30\uB85D \uD604\uD669","\uBC1C\uB2EC \uBD84\uC11D","\uBAA9\uD45C \uC81C\uC548"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0},{id:"workout-balance",name:"\uC6B4\uB3D9 \uBC38\uB7F0\uC2A4 \uBD84\uC11D",category:"workout",description:"\uADFC\uC721 \uADF8\uB8F9\uBCC4 \uC6B4\uB3D9 \uADE0\uD615\uC744 \uBD84\uC11D\uD569\uB2C8\uB2E4.",isBuiltIn:!0,isEnabled:!0,systemPrompt:"\uB2F9\uC2E0\uC740 \uC6B4\uB3D9 \uADE0\uD615 \uBD84\uC11D \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4. \uADFC\uC721 \uADF8\uB8F9\uBCC4 \uC6B4\uB3D9 \uBD84\uD3EC\uB97C \uBD84\uC11D\uD558\uC5EC \uADE0\uD615 \uC7A1\uD78C \uD2B8\uB808\uC774\uB2DD\uC744 \uC81C\uC548\uD569\uB2C8\uB2E4.",userPromptTemplate:`\uB2E4\uC74C \uC6B4\uB3D9 \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uC6B4\uB3D9 \uBC38\uB7F0\uC2A4 \uB9AC\uD3EC\uD2B8\uB97C \uC791\uC131\uD574\uC8FC\uC138\uC694.

[\uBD84\uC11D \uAE30\uAC04]
{{period}}

[\uC6B4\uB3D9 \uB370\uC774\uD130]
{{rawData}}

[\uC694\uCCAD\uC0AC\uD56D]
1. \uC804\uCCB4 \uC6B4\uB3D9 \uBD84\uD3EC \uC694\uC57D
2. \uADFC\uC721 \uADF8\uB8F9\uBCC4 \uD6C8\uB828 \uBE44\uC728
3. \uBD88\uADE0\uD615 \uAC10\uC9C0 \uBC0F \uBD84\uC11D
4. \uACFC\uD6C8\uB828/\uBBF8\uD6C8\uB828 \uC601\uC5ED \uC2DD\uBCC4
5. \uADE0\uD615 \uAC1C\uC120 \uC81C\uC548

Markdown \uD615\uC2DD\uC73C\uB85C \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD574\uC8FC\uC138\uC694.`,dataRange:"month",outputFormat:"markdown",outputSections:["\uBD84\uD3EC \uC694\uC57D","\uADF8\uB8F9\uBCC4 \uBD84\uC11D","\uBD88\uADE0\uD615 \uAC10\uC9C0","\uC704\uD5D8 \uC601\uC5ED","\uAC1C\uC120 \uC81C\uC548"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0}],gt=[{id:"work-weekly",name:"\uC8FC\uAC04 \uC5C5\uBB34 \uB9AC\uD3EC\uD2B8",category:"work",description:"\uC77C\uC8FC\uC77C\uAC04\uC758 \uC5C5\uBB34 \uD604\uD669\uC744 \uBD84\uC11D\uD569\uB2C8\uB2E4.",isBuiltIn:!0,isEnabled:!0,systemPrompt:"\uB2F9\uC2E0\uC740 \uC5C5\uBB34 \uC0DD\uC0B0\uC131 \uBD84\uC11D \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4. \uC5C5\uBB34 \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uD6A8\uC728\uC801\uC778 \uC2DC\uAC04 \uAD00\uB9AC\uC640 \uC0DD\uC0B0\uC131 \uD5A5\uC0C1 \uC804\uB7B5\uC744 \uC81C\uC548\uD569\uB2C8\uB2E4.",userPromptTemplate:`\uB2E4\uC74C \uC5C5\uBB34 \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uC8FC\uAC04 \uC5C5\uBB34 \uB9AC\uD3EC\uD2B8\uB97C \uC791\uC131\uD574\uC8FC\uC138\uC694.

[\uBD84\uC11D \uAE30\uAC04]
{{period}}

[\uC5C5\uBB34 \uB370\uC774\uD130]
{{rawData}}

[\uC694\uCCAD\uC0AC\uD56D]
1. \uC8FC\uAC04 \uC5C5\uBB34 \uC694\uC57D (\uCD1D \uC5C5\uBB34 \uC2DC\uAC04, \uC644\uB8CC \uD0DC\uC2A4\uD06C \uC218)
2. \uC5C5\uBB34 \uCE74\uD14C\uACE0\uB9AC\uBCC4 \uC2DC\uAC04 \uBD84\uBC30
3. \uC0DD\uC0B0\uC131 \uD328\uD134 \uBD84\uC11D
4. \uC608\uC0C1 \uB300\uBE44 \uC2E4\uC81C \uC18C\uC694 \uC2DC\uAC04 \uBE44\uAD50
5. \uB2E4\uC74C \uC8FC \uC5C5\uBB34 \uAC1C\uC120 \uC81C\uC548

Markdown \uD615\uC2DD\uC73C\uB85C \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD574\uC8FC\uC138\uC694.`,dataRange:"week",outputFormat:"markdown",outputSections:["\uC8FC\uAC04 \uC694\uC57D","\uCE74\uD14C\uACE0\uB9AC \uBD84\uC11D","\uC0DD\uC0B0\uC131 \uBD84\uC11D","\uC2DC\uAC04 \uBE44\uAD50","\uAC1C\uC120 \uC81C\uC548"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0},{id:"work-productivity",name:"\uC0DD\uC0B0\uC131 \uBD84\uC11D",category:"work",description:"\uC5C5\uBB34 \uC0DD\uC0B0\uC131\uACFC \uD6A8\uC728\uC744 \uBD84\uC11D\uD569\uB2C8\uB2E4.",isBuiltIn:!0,isEnabled:!0,systemPrompt:"\uB2F9\uC2E0\uC740 \uC5C5\uBB34 \uD6A8\uC728 \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4. \uC5C5\uBB34 \uD328\uD134\uC744 \uBD84\uC11D\uD558\uC5EC \uC0DD\uC0B0\uC131 \uCD5C\uC801\uD654 \uBC29\uC548\uC744 \uC81C\uC2DC\uD569\uB2C8\uB2E4.",userPromptTemplate:`\uB2E4\uC74C \uC5C5\uBB34 \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uC0DD\uC0B0\uC131 \uBD84\uC11D \uB9AC\uD3EC\uD2B8\uB97C \uC791\uC131\uD574\uC8FC\uC138\uC694.

[\uBD84\uC11D \uAE30\uAC04]
{{period}}

[\uC5C5\uBB34 \uB370\uC774\uD130]
{{rawData}}

[\uC694\uCCAD\uC0AC\uD56D]
1. \uC804\uBC18\uC801\uC778 \uC0DD\uC0B0\uC131 \uC810\uC218
2. \uC2DC\uAC04\uB300\uBCC4 \uC0DD\uC0B0\uC131 \uD328\uD134
3. \uC5C5\uBB34 \uC644\uB8CC\uC728 \uBC0F \uC9C0\uC5F0 \uBD84\uC11D
4. \uC9D1\uC911 \uC5C5\uBB34 \uC2DC\uAC04 \uBD84\uC11D
5. \uC0DD\uC0B0\uC131 \uD5A5\uC0C1 \uC804\uB7B5

Markdown \uD615\uC2DD\uC73C\uB85C \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD574\uC8FC\uC138\uC694.`,dataRange:"week",outputFormat:"markdown",outputSections:["\uC0DD\uC0B0\uC131 \uC810\uC218","\uC2DC\uAC04\uB300 \uBD84\uC11D","\uC644\uB8CC\uC728 \uBD84\uC11D","\uC9D1\uC911 \uC2DC\uAC04","\uD5A5\uC0C1 \uC804\uB7B5"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0},{id:"work-burnout",name:"\uBC88\uC544\uC6C3 \uC704\uD5D8 \uBD84\uC11D",category:"work",description:"\uACFC\uB85C \uD328\uD134\uACFC \uBC88\uC544\uC6C3 \uC704\uD5D8\uC744 \uBD84\uC11D\uD569\uB2C8\uB2E4.",isBuiltIn:!0,isEnabled:!0,systemPrompt:"\uB2F9\uC2E0\uC740 \uC6CC\uB77C\uBC38 \uC804\uBB38 \uC0C1\uB2F4\uC0AC\uC785\uB2C8\uB2E4. \uC5C5\uBB34 \uD328\uD134\uC744 \uBD84\uC11D\uD558\uC5EC \uBC88\uC544\uC6C3 \uC704\uD5D8\uC744 \uD3C9\uAC00\uD558\uACE0 \uAC74\uAC15\uD55C \uC5C5\uBB34 \uBC29\uC2DD\uC744 \uC81C\uC548\uD569\uB2C8\uB2E4.",userPromptTemplate:`\uB2E4\uC74C \uC5C5\uBB34 \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uBC88\uC544\uC6C3 \uC704\uD5D8 \uBD84\uC11D \uB9AC\uD3EC\uD2B8\uB97C \uC791\uC131\uD574\uC8FC\uC138\uC694.

[\uBD84\uC11D \uAE30\uAC04]
{{period}}

[\uC5C5\uBB34 \uB370\uC774\uD130]
{{rawData}}

[\uC694\uCCAD\uC0AC\uD56D]
1. \uBC88\uC544\uC6C3 \uC704\uD5D8\uB3C4 \uD3C9\uAC00 (\uB0AE\uC74C/\uBCF4\uD1B5/\uB192\uC74C)
2. \uC57C\uADFC \uBC0F \uCD08\uACFC \uADFC\uBB34 \uD328\uD134
3. \uD734\uC2DD \uBC0F \uD68C\uBCF5 \uC2DC\uAC04 \uBD84\uC11D
4. \uC2A4\uD2B8\uB808\uC2A4 \uC694\uC778 \uC2DD\uBCC4
5. \uC6CC\uB77C\uBC38 \uAC1C\uC120 \uC81C\uC548

Markdown \uD615\uC2DD\uC73C\uB85C \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD574\uC8FC\uC138\uC694.`,dataRange:"week",outputFormat:"markdown",outputSections:["\uC704\uD5D8\uB3C4 \uD3C9\uAC00","\uCD08\uACFC \uADFC\uBB34 \uBD84\uC11D","\uD734\uC2DD \uBD84\uC11D","\uC2A4\uD2B8\uB808\uC2A4 \uC694\uC778","\uAC1C\uC120 \uC81C\uC548"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0}],ft=[{id:"meal-weekly",name:"\uC8FC\uAC04 \uC2DD\uB2E8 \uB9AC\uD3EC\uD2B8",category:"meal",description:"\uC77C\uC8FC\uC77C\uAC04\uC758 \uC2DD\uC0AC \uD328\uD134\uC744 \uBD84\uC11D\uD569\uB2C8\uB2E4.",isBuiltIn:!0,isEnabled:!0,systemPrompt:"\uB2F9\uC2E0\uC740 \uC601\uC591 \uBC0F \uC2DD\uC2B5\uAD00 \uBD84\uC11D \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4. \uC2DD\uC0AC \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uAC74\uAC15\uD55C \uC2DD\uC2B5\uAD00 \uD615\uC131\uC744 \uB3D5\uC2B5\uB2C8\uB2E4.",userPromptTemplate:`\uB2E4\uC74C \uC2DD\uC0AC \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uC8FC\uAC04 \uC2DD\uB2E8 \uB9AC\uD3EC\uD2B8\uB97C \uC791\uC131\uD574\uC8FC\uC138\uC694.

[\uBD84\uC11D \uAE30\uAC04]
{{period}}

[\uC2DD\uC0AC \uB370\uC774\uD130]
{{rawData}}

[\uC694\uCCAD\uC0AC\uD56D]
1. \uC8FC\uAC04 \uC2DD\uC0AC \uC694\uC57D (\uB07C\uB2C8\uBCC4 \uC2DD\uC0AC \uD69F\uC218)
2. \uC2DD\uC0AC \uADDC\uCE59\uC131 \uBD84\uC11D
3. \uC74C\uC2DD \uB2E4\uC591\uC131 \uD3C9\uAC00
4. \uC2DD\uC0AC \uC2DC\uAC04\uB300 \uD328\uD134
5. \uAC1C\uC120 \uC81C\uC548

Markdown \uD615\uC2DD\uC73C\uB85C \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD574\uC8FC\uC138\uC694.`,dataRange:"week",outputFormat:"markdown",outputSections:["\uC8FC\uAC04 \uC694\uC57D","\uADDC\uCE59\uC131 \uBD84\uC11D","\uB2E4\uC591\uC131 \uBD84\uC11D","\uC2DC\uAC04\uB300 \uBD84\uC11D","\uAC1C\uC120 \uC81C\uC548"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0},{id:"meal-pattern",name:"\uC2DD\uC0AC \uD328\uD134 \uBD84\uC11D",category:"meal",description:"\uC2DD\uC0AC \uC2DC\uAC04\uACFC \uADDC\uCE59\uC131\uC744 \uBD84\uC11D\uD569\uB2C8\uB2E4.",isBuiltIn:!0,isEnabled:!0,systemPrompt:"\uB2F9\uC2E0\uC740 \uC2DD\uC2B5\uAD00 \uD328\uD134 \uBD84\uC11D \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4. \uC2DD\uC0AC \uC2DC\uAC04\uACFC \uADDC\uCE59\uC131\uC744 \uBD84\uC11D\uD558\uC5EC \uAC74\uAC15\uD55C \uC2DD\uC0AC \uC2B5\uAD00\uC744 \uC81C\uC548\uD569\uB2C8\uB2E4.",userPromptTemplate:`\uB2E4\uC74C \uC2DD\uC0AC \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uC2DD\uC0AC \uD328\uD134 \uBD84\uC11D \uB9AC\uD3EC\uD2B8\uB97C \uC791\uC131\uD574\uC8FC\uC138\uC694.

[\uBD84\uC11D \uAE30\uAC04]
{{period}}

[\uC2DD\uC0AC \uB370\uC774\uD130]
{{rawData}}

[\uC694\uCCAD\uC0AC\uD56D]
1. \uC2DD\uC0AC \uADDC\uCE59\uC131 \uC810\uC218
2. \uB07C\uB2C8\uBCC4 \uC2DD\uC0AC \uC2DC\uAC04 \uBD84\uC11D
3. \uACB0\uC2DD \uD328\uD134 \uBD84\uC11D
4. \uC2DD\uC0AC \uAC04\uACA9 \uBD84\uC11D
5. \uADDC\uCE59\uC801\uC778 \uC2DD\uC0AC\uB97C \uC704\uD55C \uC870\uC5B8

Markdown \uD615\uC2DD\uC73C\uB85C \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD574\uC8FC\uC138\uC694.`,dataRange:"week",outputFormat:"markdown",outputSections:["\uADDC\uCE59\uC131 \uC810\uC218","\uC2DC\uAC04 \uBD84\uC11D","\uACB0\uC2DD \uBD84\uC11D","\uAC04\uACA9 \uBD84\uC11D","\uAC1C\uC120 \uC870\uC5B8"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0},{id:"meal-nutrition",name:"\uC601\uC591 \uBC38\uB7F0\uC2A4 \uBD84\uC11D",category:"meal",description:"\uC74C\uC2DD \uB2E4\uC591\uC131\uACFC \uC601\uC591 \uADE0\uD615\uC744 \uBD84\uC11D\uD569\uB2C8\uB2E4.",isBuiltIn:!0,isEnabled:!0,systemPrompt:"\uB2F9\uC2E0\uC740 \uC601\uC591 \uBD84\uC11D \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4. \uC2DD\uC0AC \uAE30\uB85D\uC5D0\uC11C \uC601\uC591 \uADE0\uD615\uACFC \uB2E4\uC591\uC131\uC744 \uBD84\uC11D\uD558\uC5EC \uAC74\uAC15\uD55C \uC2DD\uB2E8\uC744 \uC81C\uC548\uD569\uB2C8\uB2E4.",userPromptTemplate:`\uB2E4\uC74C \uC2DD\uC0AC \uAE30\uB85D\uC744 \uBD84\uC11D\uD558\uC5EC \uC601\uC591 \uBC38\uB7F0\uC2A4 \uBD84\uC11D \uB9AC\uD3EC\uD2B8\uB97C \uC791\uC131\uD574\uC8FC\uC138\uC694.

[\uBD84\uC11D \uAE30\uAC04]
{{period}}

[\uC2DD\uC0AC \uB370\uC774\uD130]
{{rawData}}

[\uC694\uCCAD\uC0AC\uD56D]
1. \uC74C\uC2DD \uB2E4\uC591\uC131 \uC810\uC218
2. \uC790\uC8FC \uBA39\uB294 \uC74C\uC2DD TOP 10
3. \uC601\uC591\uC18C \uADE0\uD615 \uCD94\uC815 (\uD0C4\uC218\uD654\uBB3C, \uB2E8\uBC31\uC9C8, \uCC44\uC18C \uB4F1)
4. \uBD80\uC871\uD560 \uC218 \uC788\uB294 \uC601\uC591 \uC694\uC18C
5. \uC2DD\uB2E8 \uAC1C\uC120 \uC81C\uC548

Markdown \uD615\uC2DD\uC73C\uB85C \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD574\uC8FC\uC138\uC694.`,dataRange:"month",outputFormat:"markdown",outputSections:["\uB2E4\uC591\uC131 \uC810\uC218","\uBE48\uB3C4 \uBD84\uC11D","\uC601\uC591 \uADE0\uD615","\uBD80\uC871 \uC601\uC591\uC18C","\uAC1C\uC120 \uC81C\uC548"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0}],Jr=[...pt,...mt,...gt,...ft];function ht(n){switch(n){case"study":return pt;case"workout":return mt;case"work":return gt;case"meal":return ft;default:return[]}}var D=class{static render(t,e){let r=t;return r=r.replace(/\{\{period\}\}/g,e.period),r=r.replace(/\{\{category\}\}/g,e.category),r=r.replace(/\{\{recordCount\}\}/g,String(e.recordCount)),r=r.replace(/\{\{totalDuration\}\}/g,e.totalDuration),r=r.replace(/\{\{rawData\}\}/g,e.rawData),r=r.replace(/\{\{summary\}\}/g,e.summary),r=r.replace(/\{\{userName\}\}/g,e.userName||"\uC0AC\uC6A9\uC790"),r=r.replace(/\{\{currentDate\}\}/g,e.currentDate),r}static formatDateRange(t){let e=r=>{let a=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),s=String(r.getDate()).padStart(2,"0");return`${a}-${o}-${s}`};return`${e(t.start)} ~ ${e(t.end)}`}static getCurrentDateString(){let t=new Date,e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${a}`}static formatDuration(t){if(t<60)return`${t}\uCD08`;let e=Math.floor(t/3600),r=Math.floor(t%3600/60),a=t%60,o=[];return e>0&&o.push(`${e}\uC2DC\uAC04`),r>0&&o.push(`${r}\uBD84`),a>0&&e===0&&o.push(`${a}\uCD08`),o.join(" ")||"0\uCD08"}static calculateDateRange(t,e){let r=new Date;r.setHours(23,59,59,999);let a=new Date;switch(a.setHours(0,0,0,0),t){case"day":break;case"week":a.setDate(a.getDate()-6);break;case"month":a.setDate(a.getDate()-29);break;case"quarter":a.setDate(a.getDate()-89);break;case"custom":e&&e>0&&a.setDate(a.getDate()-(e-1));break}return{start:a,end:r}}static validateTemplate(t){let e=[];return(!t.id||t.id.trim()==="")&&e.push("\uD15C\uD50C\uB9BF ID\uAC00 \uD544\uC694\uD569\uB2C8\uB2E4."),(!t.name||t.name.trim()==="")&&e.push("\uD15C\uD50C\uB9BF \uC774\uB984\uC774 \uD544\uC694\uD569\uB2C8\uB2E4."),(!t.userPromptTemplate||t.userPromptTemplate.trim()==="")&&e.push("\uC0AC\uC6A9\uC790 \uD504\uB86C\uD504\uD2B8 \uD15C\uD50C\uB9BF\uC774 \uD544\uC694\uD569\uB2C8\uB2E4."),t.userPromptTemplate.includes("{{rawData}}")||e.push("\uD504\uB86C\uD504\uD2B8\uC5D0 {{rawData}} \uBCC0\uC218\uAC00 \uD3EC\uD568\uB418\uC5B4\uC57C \uD569\uB2C8\uB2E4."),{valid:e.length===0,errors:e}}static getCategoryName(t){switch(t){case"study":return"\uD559\uC2B5";case"workout":return"\uC6B4\uB3D9";case"work":return"\uC5C5\uBB34";case"meal":return"\uC2DD\uB2E8";default:return t}}};var P=class{constructor(t,e){this.apiKey=t,this.model=e}isConfigured(){return!!this.apiKey&&this.apiKey.length>0}getCurrentModel(){return this.model}createResult(t,e,r,a){return{success:t,content:e,metadata:{provider:this.name,model:this.model,tokensUsed:r,generatedAt:new Date().toISOString()},error:a}}createErrorResult(t){let e=t instanceof Error?t.message:String(t);return this.createResult(!1,"",void 0,e)}};async function L(n,t,e=6e4){let r=new AbortController,a=setTimeout(()=>r.abort(),e);try{return await fetch(n,{...t,signal:r.signal})}finally{clearTimeout(a)}}var K=class K extends P{constructor(){super(...arguments);this.name="OpenAI";this.type="openai"}getAvailableModels(){return K.MODELS}async testConnection(){if(!this.isConfigured())return!1;try{return(await L("https://api.openai.com/v1/models",{method:"GET",headers:{Authorization:`Bearer ${this.apiKey}`}},1e4)).ok}catch(e){return!1}}async analyze(e,r){var a,o,s,i,l,d;if(!this.isConfigured())return this.createResult(!1,"",void 0,"API \uD0A4\uAC00 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");try{let c=[];r!=null&&r.systemPrompt&&c.push({role:"system",content:r.systemPrompt}),c.push({role:"user",content:e});let u=await L(K.API_URL,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({model:(r==null?void 0:r.model)||this.model,messages:c,temperature:(a=r==null?void 0:r.temperature)!=null?a:.7,max_tokens:(o=r==null?void 0:r.maxTokens)!=null?o:4096})}),p=await u.json();if(!u.ok||p.error)return this.createResult(!1,"",void 0,((s=p.error)==null?void 0:s.message)||`HTTP ${u.status}`);let m=((l=(i=p.choices[0])==null?void 0:i.message)==null?void 0:l.content)||"",g=(d=p.usage)==null?void 0:d.total_tokens;return this.createResult(!0,m,g)}catch(c){return this.createErrorResult(c)}}};K.API_URL="https://api.openai.com/v1/chat/completions",K.MODELS=["gpt-5.2","gpt-5","o4-mini","o3","gpt-4o","gpt-4o-mini"];var Z=K;var _=class _ extends P{constructor(){super(...arguments);this.name="Gemini";this.type="gemini"}getAvailableModels(){return _.MODELS}async testConnection(){if(!this.isConfigured())return!1;try{return(await L(`${_.API_BASE}?key=${this.apiKey}`,{method:"GET",headers:{}},1e4)).ok}catch(e){return!1}}async analyze(e,r){var a,o,s,i,l,d,c,u,p;if(!this.isConfigured())return this.createResult(!1,"",void 0,"API \uD0A4\uAC00 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");try{let m=(r==null?void 0:r.model)||this.model,g=[],h;r!=null&&r.systemPrompt&&(h=r.systemPrompt),g.push({role:"user",parts:[{text:e}]});let y={contents:g,generationConfig:{temperature:(a=r==null?void 0:r.temperature)!=null?a:.7,maxOutputTokens:(o=r==null?void 0:r.maxTokens)!=null?o:8192}};h&&(y.systemInstruction={parts:[{text:h}]});let f=await L(`${_.API_BASE}/${m}:generateContent?key=${this.apiKey}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)}),v=await f.json();if(!f.ok||v.error)return this.createResult(!1,"",void 0,((s=v.error)==null?void 0:s.message)||`HTTP ${f.status}`);let S=((u=(c=(d=(l=(i=v.candidates)==null?void 0:i[0])==null?void 0:l.content)==null?void 0:d.parts)==null?void 0:c[0])==null?void 0:u.text)||"",T=(p=v.usageMetadata)==null?void 0:p.totalTokenCount;return this.createResult(!0,S,T)}catch(m){return this.createErrorResult(m)}}};_.API_BASE="https://generativelanguage.googleapis.com/v1beta/models",_.MODELS=["gemini-3-pro-preview","gemini-3-flash-preview","gemini-2.5-pro","gemini-2.5-flash","gemini-2.5-flash-lite"];var ee=_;var Y=class Y extends P{constructor(){super(...arguments);this.name="Grok";this.type="grok"}getAvailableModels(){return Y.MODELS}async testConnection(){if(!this.isConfigured())return!1;try{return(await L("https://api.x.ai/v1/models",{method:"GET",headers:{Authorization:`Bearer ${this.apiKey}`}},1e4)).ok}catch(e){return!1}}async analyze(e,r){var a,o,s,i,l,d;if(!this.isConfigured())return this.createResult(!1,"",void 0,"API \uD0A4\uAC00 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");try{let c=[];r!=null&&r.systemPrompt&&c.push({role:"system",content:r.systemPrompt}),c.push({role:"user",content:e});let u=await L(Y.API_URL,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({model:(r==null?void 0:r.model)||this.model,messages:c,temperature:(a=r==null?void 0:r.temperature)!=null?a:.7,max_tokens:(o=r==null?void 0:r.maxTokens)!=null?o:4096})}),p=await u.json();if(!u.ok||p.error)return this.createResult(!1,"",void 0,((s=p.error)==null?void 0:s.message)||`HTTP ${u.status}`);let m=((l=(i=p.choices[0])==null?void 0:i.message)==null?void 0:l.content)||"",g=(d=p.usage)==null?void 0:d.total_tokens;return this.createResult(!0,m,g)}catch(c){return this.createErrorResult(c)}}};Y.API_URL="https://api.x.ai/v1/chat/completions",Y.MODELS=["grok-4-1-fast","grok-4-heavy","grok-4","grok-3","grok-3-mini"];var te=Y;var V=class V extends P{constructor(e,r,a=[]){super(e,r);this.name="OpenRouter";this.type="openrouter";this.customModels=a}getAvailableModels(){let e=[...V.DEFAULT_MODELS];for(let r of this.customModels)r&&!e.includes(r)&&e.push(r);return e}async testConnection(){if(!this.isConfigured())return!1;try{return(await L("https://openrouter.ai/api/v1/auth/key",{method:"GET",headers:{Authorization:`Bearer ${this.apiKey}`}},1e4)).ok}catch(e){return!1}}async getCredits(){var e,r;if(!this.isConfigured())return null;try{let a=await L("https://openrouter.ai/api/v1/auth/key",{method:"GET",headers:{Authorization:`Bearer ${this.apiKey}`}},1e4);return a.ok&&(r=(e=(await a.json()).data)==null?void 0:e.limit_remaining)!=null?r:null}catch(a){return null}}async analyze(e,r){var a,o,s,i,l,d;if(!this.isConfigured())return this.createResult(!1,"",void 0,"API \uD0A4\uAC00 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");try{let c=[];r!=null&&r.systemPrompt&&c.push({role:"system",content:r.systemPrompt}),c.push({role:"user",content:e});let u=await L(V.API_URL,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json","HTTP-Referer":"https://obsidian.md","X-Title":"Life Log Plugin"},body:JSON.stringify({model:(r==null?void 0:r.model)||this.model,messages:c,temperature:(a=r==null?void 0:r.temperature)!=null?a:.7,max_tokens:(o=r==null?void 0:r.maxTokens)!=null?o:4096})}),p=await u.json();if(!u.ok||p.error)return this.createResult(!1,"",void 0,((s=p.error)==null?void 0:s.message)||`HTTP ${u.status}`);let m=((l=(i=p.choices[0])==null?void 0:i.message)==null?void 0:l.content)||"",g=(d=p.usage)==null?void 0:d.total_tokens;return this.createResult(!0,m,g)}catch(c){return this.createErrorResult(c)}}};V.API_URL="https://openrouter.ai/api/v1/chat/completions",V.DEFAULT_MODELS=["anthropic/claude-sonnet-4","anthropic/claude-opus-4","openai/gpt-5","openai/o3","google/gemini-2.5-pro","google/gemini-3-flash-preview","meta-llama/llama-4-maverick","deepseek/deepseek-r1"];var re=V;var xe=class{static createProvider(t,e){switch(t){case"openai":return new Z(e.openaiApiKey,e.openaiModel);case"gemini":return new ee(e.geminiApiKey,e.geminiModel);case"grok":return new te(e.grokApiKey,e.grokModel);case"openrouter":return new re(e.openRouterApiKey,e.openRouterModel,e.openRouterCustomModels);default:throw new Error(`Unknown provider type: ${t}`)}}static createDefaultProvider(t){return this.createProvider(t.defaultProvider,t)}static getConfiguredProviders(t){let e=[];return t.openaiApiKey&&e.push(this.createProvider("openai",t)),t.geminiApiKey&&e.push(this.createProvider("gemini",t)),t.grokApiKey&&e.push(this.createProvider("grok",t)),t.openRouterApiKey&&e.push(this.createProvider("openrouter",t)),e}static getProviderName(t){switch(t){case"openai":return"OpenAI";case"gemini":return"Google Gemini";case"grok":return"xAI Grok";case"openrouter":return"OpenRouter";default:return t}}static isProviderConfigured(t,e){switch(t){case"openai":return!!e.openaiApiKey;case"gemini":return!!e.geminiApiKey;case"grok":return!!e.grokApiKey;case"openrouter":return!!e.openRouterApiKey;default:return!1}}};var M=class{constructor(t,e){this.app=t,this.logFolder=e}async collect(t){let e=[],r=this.app.vault.getMarkdownFiles();for(let a of r)if(!(this.logFolder&&!a.path.startsWith(this.logFolder)))try{let o=await this.app.vault.cachedRead(a),s=this.extractCodeBlocks(o);for(let i of s){let l=this.parseBlock(i.content);if(!l)continue;let d=this.extractDate(l);d&&d>=t.start&&d<=t.end&&e.push({file:a,filePath:a.path,data:l,date:d})}}catch(o){console.error(`Error reading file ${a.path}:`,o)}return e.sort((a,o)=>a.date.getTime()-o.date.getTime()),{logs:e,totalCount:e.length,dateRange:t,category:this.category}}extractCodeBlocks(t){var l;let e=[],r=t.split(`
`),a=!1,o="",s=[],i=0;for(let d=0;d<r.length;d++){let c=(l=r[d])!=null?l:"";if(c.startsWith("```")&&!a){let u=c.slice(3).trim();u===this.codeBlockType&&(a=!0,o=u,s=[],i=d)}else c.startsWith("```")&&a?(o===this.codeBlockType&&e.push({content:s.join(`
`),startLine:i,endLine:d}),a=!1,o="",s=[]):a&&s.push(c)}return e}parseDateString(t){if(!t)return null;let e=t.match(/^(\d{4})-(\d{2})-(\d{2})(?:\s+(\d{2}):(\d{2}))?/);if(e&&e[1]&&e[2]&&e[3]){let r=parseInt(e[1],10),a=parseInt(e[2],10)-1,o=parseInt(e[3],10),s=e[4]?parseInt(e[4],10):0,i=e[5]?parseInt(e[5],10):0;return new Date(r,a,o,s,i)}return null}parseDurationToSeconds(t){if(!t)return 0;let e=0,r=t.match(/(\d+)\s*(?:h|)/);r&&r[1]&&(e+=parseInt(r[1],10)*3600);let a=t.match(/(\d+)\s*(?:m|)/);a&&a[1]&&(e+=parseInt(a[1],10)*60);let o=t.match(/(\d+)\s*(?:s|)/);return o&&o[1]&&(e+=parseInt(o[1],10)),e}};var F=class extends M{constructor(e,r){super(e,r);this.category="study";this.codeBlockType="study-log"}parseBlock(e){try{let r=ce(e);return r.metadata.title||r.tasks.length>0?r:null}catch(r){return console.error("Error parsing study log:",r),null}}extractDate(e){return this.parseDateString(e.metadata.startDate)}async collectForAnalysis(e){let r=await this.collect(e),a=new Map,o=0,s=0,i=[];for(let d of r.logs){let c=d.data,u=c.metadata.subject||"\uAE30\uD0C0",p=this.parseDurationToSeconds(c.metadata.totalDuration);o+=p;let m=a.get(u)||{duration:0,count:0};m.duration+=p,m.count+=1,a.set(u,m),(c.metadata.focusScore!==void 0||c.metadata.comprehensionScore!==void 0)&&i.push({understanding:c.metadata.comprehensionScore||0,effort:c.metadata.focusScore||0,satisfaction:Math.round((c.metadata.focusScore||0)*.5+(c.metadata.comprehensionScore||0)*.5)});let g=c.tasks.filter(h=>h.state==="completed");s+=g.length}let l=Array.from(a.entries()).map(([d,c])=>({subject:d,duration:c.duration,count:c.count}));return l.sort((d,c)=>c.duration-d.duration),{period:e,sessions:r.logs.map(d=>d.data),subjectStats:l,totalStudyTime:o,pomodoroCount:s,scores:i}}toJSON(e){let r=e.logs.map(a=>({date:a.date.toISOString().split("T")[0],title:a.data.metadata.title,subject:a.data.metadata.subject,state:a.data.metadata.state,totalDuration:a.data.metadata.totalDuration,focusScore:a.data.metadata.focusScore,comprehensionScore:a.data.metadata.comprehensionScore,tasks:a.data.tasks.map(o=>({name:o.name,state:o.state,duration:o.recordedDuration})),tags:a.data.metadata.tags}));return JSON.stringify(r,null,2)}};var H=class extends M{constructor(e,r){super(e,r);this.category="workout";this.codeBlockType="life-log"}parseBlock(e){try{let r=oe(e);return r.metadata.title||r.exercises.length>0?r:null}catch(r){return console.error("Error parsing workout log:",r),null}}extractDate(e){return this.parseDateString(e.metadata.startDate)}async collectForAnalysis(e){let r=await this.collect(e),a=new Map,o=0,s=0,i=0;for(let c of r.logs){let u=c.data;i++;let p=this.parseDurationToSeconds(u.metadata.duration);o+=p,u.metadata.state==="completed"&&s++;for(let m of u.exercises){let g=m.name,h=a.get(g)||{totalSets:0,totalReps:0};h.totalSets+=1;let y=m.params.find(f=>f.key.toLowerCase().includes("rep")||f.key.toLowerCase().includes("\uD69F\uC218"));if(y){let f=parseInt(y.value)||0;h.totalReps+=f}a.set(g,h)}}let l=Array.from(a.entries()).map(([c,u])=>({name:c,totalSets:u.totalSets,totalReps:u.totalReps}));l.sort((c,u)=>u.totalSets-c.totalSets);let d=i>0?s/i*100:0;return{period:e,workouts:r.logs.map(c=>c.data),exerciseStats:l,totalDuration:o,completionRate:d}}toJSON(e){let r=e.logs.map(a=>({date:a.date.toISOString().split("T")[0],title:a.data.metadata.title,state:a.data.metadata.state,duration:a.data.metadata.duration,exercises:a.data.exercises.map(o=>({name:o.name,state:o.state,params:o.params.reduce((s,i)=>(s[i.key]=i.value+(i.unit?` ${i.unit}`:""),s),{}),duration:o.recordedDuration}))}));return JSON.stringify(r,null,2)}};var O=class extends M{constructor(e,r){super(e,r);this.category="work";this.codeBlockType="work-log"}parseBlock(e){try{let r=me(e);return r.metadata.title||r.tasks.length>0?r:null}catch(r){return console.error("Error parsing work log:",r),null}}extractDate(e){return this.parseDateString(e.metadata.startDate)}async collectForAnalysis(e){let r=await this.collect(e),a=new Map,o=0,s=0,i=0,l=0;for(let u of r.logs){let p=u.data;l++;let m=this.parseDurationToSeconds(p.metadata.totalDuration);o+=m,p.metadata.state==="completed"&&i++;for(let h of p.tasks)if(h.expectedDuration&&h.actualDuration){let y=h.expectedDuration;this.parseDurationToSeconds(h.actualDuration)>y*1.2&&s++}let g=p.metadata.tags||["\uBBF8\uBD84\uB958"];for(let h of g){let y=a.get(h)||{duration:0,count:0};y.duration+=m/g.length,y.count+=1,a.set(h,y)}}let d=Array.from(a.entries()).map(([u,p])=>({category:u,duration:Math.round(p.duration),count:p.count}));d.sort((u,p)=>p.duration-u.duration);let c=l>0?i/l*100:0;return{period:e,tasks:r.logs.map(u=>u.data),categoryStats:d,totalWorkTime:o,overtimeCount:s,completionRate:c}}toJSON(e){let r=e.logs.map(a=>({date:a.date.toISOString().split("T")[0],title:a.data.metadata.title,state:a.data.metadata.state,totalDuration:a.data.metadata.totalDuration,tasks:a.data.tasks.map(o=>({name:o.name,state:o.state,priority:o.priority,expectedDuration:o.expectedDuration,actualDuration:o.actualDuration,notes:o.notes})),tags:a.data.metadata.tags}));return JSON.stringify(r,null,2)}};var U=class extends M{constructor(e,r){super(e,r);this.category="meal";this.codeBlockType="meal-log"}parseBlock(e){try{let r=he(e);return r.metadata.title||r.foods.length>0?r:null}catch(r){return console.error("Error parsing meal log:",r),null}}extractDate(e){return this.parseDateString(e.metadata.date)}async collectForAnalysis(e){var p;let r=await this.collect(e),a=new Map,o=new Map,s=new Map;for(let m of r.logs){let g=m.data,h=(p=m.date.toISOString().split("T")[0])!=null?p:"",y=g.metadata.mealType;a.set(y,(a.get(y)||0)+1),h&&s.set(h,(s.get(h)||0)+1);for(let f of g.foods){let v=f.name.toLowerCase().trim();o.set(v,(o.get(v)||0)+1)}}let i=[{type:"breakfast",count:a.get("breakfast")||0},{type:"lunch",count:a.get("lunch")||0},{type:"dinner",count:a.get("dinner")||0},{type:"snack",count:a.get("snack")||0}],l=Array.from(o.entries()).map(([m,g])=>({name:m,count:g})).sort((m,g)=>g.count-m.count).slice(0,20),d=s.size,c=0;for(let m of s.values())m>=3&&c++;let u=d>0?Math.round(c/d*100):0;return{period:e,meals:r.logs.map(m=>m.data),mealTypeStats:i,foodFrequency:l,regularityScore:u}}toJSON(e){let r=e.logs.map(a=>({date:a.date.toISOString().split("T")[0],title:a.data.metadata.title,mealType:a.data.metadata.mealType,state:a.data.metadata.state,foods:a.data.foods.map(o=>o.name),notes:a.data.metadata.notes}));return JSON.stringify(r,null,2)}};var ae=class{static createCollector(t,e,r){switch(t){case"study":return new F(e,r);case"workout":return new H(e,r);case"work":return new O(e,r);case"meal":return new U(e,r);default:throw new Error(`Unknown category: ${t}`)}}static createAllCollectors(t,e){let r=new Map;return r.set("study",new F(t,e)),r.set("workout",new H(t,e)),r.set("work",new O(t,e)),r.set("meal",new U(t,e)),r}};function Kt(n,t,e){switch(n){case"study":return t.toJSON(e);case"workout":return t.toJSON(e);case"work":return t.toJSON(e);case"meal":return t.toJSON(e);default:return JSON.stringify(e.logs.map(r=>r.data),null,2)}}var we=class{constructor(t,e,r){this.app=t,this.settings=e,this.logFolder=r}async analyze(t,e){try{e==null||e({stage:"collecting",message:"\uB370\uC774\uD130\uB97C \uC218\uC9D1\uD558\uB294 \uC911...",progress:10});let r=await this.collectData(t.category,t.dateRange);if(r.totalCount===0)return this.createErrorResult("\uC120\uD0DD\uD55C \uAE30\uAC04\uC5D0 \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. \uB2E4\uB978 \uAE30\uAC04\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");e==null||e({stage:"processing",message:"\uB370\uC774\uD130\uB97C \uCC98\uB9AC\uD558\uB294 \uC911...",progress:30});let a=await this.processData(t.category,r);e==null||e({stage:"analyzing",message:"AI\uAC00 \uBD84\uC11D\uD558\uB294 \uC911...",progress:50});let o=this.createProvider(t.providerType);if(!o.isConfigured())return this.createErrorResult(`${o.name} API \uD0A4\uAC00 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4. \uC124\uC815\uC5D0\uC11C API \uD0A4\uB97C \uC785\uB825\uD574\uC8FC\uC138\uC694.`);let s=this.buildPrompt(t.template,t.category,t.dateRange,a);e==null||e({stage:"analyzing",message:"AI \uC751\uB2F5\uC744 \uAE30\uB2E4\uB9AC\uB294 \uC911...",progress:70});let i=await o.analyze(s,{systemPrompt:t.template.systemPrompt,model:t.model,temperature:.7,maxTokens:4096});return e==null||e({stage:"completed",message:"\uBD84\uC11D\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4!",progress:100}),i}catch(r){return e==null||e({stage:"error",message:r instanceof Error?r.message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958",progress:0}),this.createErrorResult(r instanceof Error?r.message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}}async collectData(t,e){return await ae.createCollector(t,this.app,this.logFolder).collect(e)}async processData(t,e){let r=ae.createCollector(t,this.app,this.logFolder),a=Kt(t,r,e),o=this.generateSummary(t,e),s=await this.calculateTotalDuration(t,e);return{rawData:a,summary:o,totalDuration:s}}generateSummary(t,e){let r=e.totalCount,a=D.getCategoryName(t);switch(t){case"study":return`\uCD1D ${r}\uAC1C\uC758 \uD559\uC2B5 \uC138\uC158\uC774 \uAE30\uB85D\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`;case"workout":return`\uCD1D ${r}\uAC1C\uC758 \uC6B4\uB3D9 \uAE30\uB85D\uC774 \uC788\uC2B5\uB2C8\uB2E4.`;case"work":return`\uCD1D ${r}\uAC1C\uC758 \uC5C5\uBB34 \uAE30\uB85D\uC774 \uC788\uC2B5\uB2C8\uB2E4.`;case"meal":return`\uCD1D ${r}\uAC1C\uC758 \uC2DD\uC0AC \uAE30\uB85D\uC774 \uC788\uC2B5\uB2C8\uB2E4.`;default:return`\uCD1D ${r}\uAC1C\uC758 ${a} \uAE30\uB85D\uC774 \uC788\uC2B5\uB2C8\uB2E4.`}}async calculateTotalDuration(t,e){let r=0;switch(t){case"study":{r=(await new F(this.app,this.logFolder).collectForAnalysis({start:new Date(0),end:new Date})).totalStudyTime;break}case"workout":{r=(await new H(this.app,this.logFolder).collectForAnalysis({start:new Date(0),end:new Date})).totalDuration;break}case"work":{r=(await new O(this.app,this.logFolder).collectForAnalysis({start:new Date(0),end:new Date})).totalWorkTime;break}case"meal":return"\uD574\uB2F9 \uC5C6\uC74C"}return D.formatDuration(r)}buildPrompt(t,e,r,a){let o={period:D.formatDateRange(r),category:e,recordCount:JSON.parse(a.rawData).length,totalDuration:a.totalDuration,rawData:a.rawData,summary:a.summary,currentDate:D.getCurrentDateString()};return D.render(t.userPromptTemplate,o)}createProvider(t){return xe.createProvider(t,this.settings)}createErrorResult(t){return{success:!1,content:"",metadata:{provider:"",model:"",generatedAt:new Date().toISOString()},error:t}}getAvailableProviders(){return[{type:"openai",name:"OpenAI",key:this.settings.openaiApiKey},{type:"gemini",name:"Google Gemini",key:this.settings.geminiApiKey},{type:"grok",name:"xAI Grok",key:this.settings.grokApiKey},{type:"openrouter",name:"OpenRouter",key:this.settings.openRouterApiKey}].map(e=>({type:e.type,name:e.name,configured:!!e.key}))}};var Ee=class extends E.Modal{constructor(e,r,a){super(e);this.selectedCategory="study";this.selectedTemplate=null;this.selectedDataRange="week";this.customDays=7;this.resultContainer=null;this.progressContainer=null;this.settings=r,this.logFolder=a,this.selectedProvider=r.defaultProvider,this.engine=new we(e,r,a),this.renderComponent=new E.Component}onOpen(){let{contentEl:e}=this;e.empty(),e.addClass("ai-analysis-modal"),this.renderComponent.load(),e.createEl("h2",{text:"\u{1F916} AI \uBD84\uC11D"}),this.renderCategorySelector(e),this.renderTemplateSelector(e),this.renderDateRangeSelector(e),this.renderProviderSelector(e),this.progressContainer=e.createDiv({cls:"analysis-progress hidden"}),this.resultContainer=e.createDiv({cls:"analysis-result hidden"}),this.renderButtons(e)}renderCategorySelector(e){let r=e.createDiv({cls:"analysis-section"});r.createEl("label",{text:"\uBD84\uC11D \uB300\uC0C1",cls:"analysis-label"});let a=[{value:"study",label:"\uD559\uC2B5",icon:"\u{1F4DA}"},{value:"workout",label:"\uC6B4\uB3D9",icon:"\u{1F4AA}"},{value:"work",label:"\uC5C5\uBB34",icon:"\u{1F4BC}"},{value:"meal",label:"\uC2DD\uB2E8",icon:"\u{1F37D}\uFE0F"}],o=r.createDiv({cls:"category-btn-group"});for(let s of a){let i=o.createEl("button",{cls:`category-btn ${this.selectedCategory===s.value?"active":""}`,text:`${s.icon} ${s.label}`});i.addEventListener("click",()=>{this.selectedCategory=s.value,this.selectedTemplate=null,o.querySelectorAll(".category-btn").forEach(l=>l.removeClass("active")),i.addClass("active"),this.updateTemplateList()})}}renderTemplateSelector(e){let r=e.createDiv({cls:"analysis-section template-section"});r.createEl("label",{text:"\uBD84\uC11D \uD15C\uD50C\uB9BF",cls:"analysis-label"});let a=r.createDiv({cls:"template-list"});a.id="template-list",this.updateTemplateList()}updateTemplateList(){var o;let e=document.getElementById("template-list");if(!e)return;e.empty();let r=ht(this.selectedCategory),a=this.settings.enabledTemplates;for(let s of r){if(!a.includes(s.id))continue;let i=e.createDiv({cls:`template-item ${((o=this.selectedTemplate)==null?void 0:o.id)===s.id?"selected":""}`}),l=i.createDiv({cls:"template-title",text:s.name}),d=i.createDiv({cls:"template-desc",text:s.description});i.addEventListener("click",()=>{this.selectedTemplate=s,e.querySelectorAll(".template-item").forEach(c=>c.removeClass("selected")),i.addClass("selected")})}if(r.length>0&&!this.selectedTemplate){let s=r.find(i=>a.includes(i.id));if(s){this.selectedTemplate=s;let i=e.querySelector(".template-item");i==null||i.addClass("selected")}}}renderDateRangeSelector(e){let r=e.createDiv({cls:"analysis-section"});r.createEl("label",{text:"\uBD84\uC11D \uAE30\uAC04",cls:"analysis-label"});let a=[{value:"day",label:"\uC624\uB298"},{value:"week",label:"\uCD5C\uADFC 7\uC77C"},{value:"month",label:"\uCD5C\uADFC 30\uC77C"},{value:"quarter",label:"\uCD5C\uADFC 90\uC77C"},{value:"custom",label:"\uC9C1\uC811 \uC785\uB825"}],o=r.createEl("select",{cls:"analysis-select"});for(let l of a){let d=o.createEl("option",{text:l.label,value:l.value});l.value===this.selectedDataRange&&(d.selected=!0)}let s=r.createDiv({cls:`custom-days-container ${this.selectedDataRange!=="custom"?"hidden":""}`}),i=s.createEl("input",{type:"number",cls:"custom-days-input",value:String(this.customDays),placeholder:"\uC77C\uC218"});s.createSpan({text:"\uC77C"}),o.addEventListener("change",()=>{this.selectedDataRange=o.value,this.selectedDataRange==="custom"?s.removeClass("hidden"):s.addClass("hidden")}),i.addEventListener("change",()=>{this.customDays=parseInt(i.value)||7})}renderProviderSelector(e){let r=e.createDiv({cls:"analysis-section"});r.createEl("label",{text:"AI Provider",cls:"analysis-label"});let a=this.engine.getAvailableProviders(),o=r.createEl("select",{cls:"analysis-select"});for(let i of a){let l=i.configured?i.name:`${i.name} (API \uD0A4 \uD544\uC694)`,d=o.createEl("option",{text:l,value:i.type});d.disabled=!i.configured,i.type===this.selectedProvider&&i.configured&&(d.selected=!0)}let s=a.find(i=>i.configured);if(s){this.selectedProvider=s.type;for(let i=0;i<o.options.length;i++){let l=o.options[i];if(l&&l.value===this.selectedProvider){l.selected=!0;break}}}o.addEventListener("change",()=>{this.selectedProvider=o.value})}renderButtons(e){let r=e.createDiv({cls:"analysis-buttons"});r.createEl("button",{cls:"analysis-btn analysis-btn-secondary",text:"\uCDE8\uC18C"}).addEventListener("click",()=>this.close());let o=r.createEl("button",{cls:"analysis-btn analysis-btn-primary",text:"\u{1F680} \uBD84\uC11D \uC2DC\uC791"});o.id="analyze-btn",o.addEventListener("click",()=>this.startAnalysis())}async startAnalysis(){if(!this.selectedTemplate){new E.Notice("\uBD84\uC11D \uD15C\uD50C\uB9BF\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");return}let r=this.engine.getAvailableProviders().find(s=>s.type===this.selectedProvider);if(!(r!=null&&r.configured)){new E.Notice(`${(r==null?void 0:r.name)||"AI"} API \uD0A4\uB97C \uC124\uC815\uD574\uC8FC\uC138\uC694.`);return}let a=document.getElementById("analyze-btn");a&&(a.disabled=!0,a.textContent="\uBD84\uC11D \uC911..."),this.showProgress();let o=D.calculateDateRange(this.selectedDataRange,this.customDays);try{let s=await this.engine.analyze({category:this.selectedCategory,template:this.selectedTemplate,dateRange:o,providerType:this.selectedProvider},i=>this.updateProgress(i));s.success?(this.showResult(s.content),new E.Notice("\uBD84\uC11D\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4!")):(this.showError(s.error||"\uBD84\uC11D \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4."),new E.Notice(`\uBD84\uC11D \uC2E4\uD328: ${s.error}`))}catch(s){let i=s instanceof Error?s.message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958";this.showError(i),new E.Notice(`\uBD84\uC11D \uC624\uB958: ${i}`)}a&&(a.disabled=!1,a.textContent="\u{1F680} \uBD84\uC11D \uC2DC\uC791")}showProgress(){this.progressContainer&&(this.progressContainer.removeClass("hidden"),this.progressContainer.empty(),this.progressContainer.createDiv({cls:"progress-bar"}).createDiv({cls:"progress-fill"}),this.progressContainer.createDiv({cls:"progress-text",text:"\uC2DC\uC791 \uC911..."})),this.resultContainer&&this.resultContainer.addClass("hidden")}updateProgress(e){if(!this.progressContainer)return;let r=this.progressContainer.querySelector(".progress-fill"),a=this.progressContainer.querySelector(".progress-text");r&&(r.style.width=`${e.progress}%`),a&&(a.textContent=e.message)}showResult(e){if(this.progressContainer&&this.progressContainer.addClass("hidden"),this.resultContainer){this.resultContainer.removeClass("hidden"),this.resultContainer.empty();let r=this.resultContainer.createDiv({cls:"result-header"});r.createEl("h3",{text:"\u{1F4CA} \uBD84\uC11D \uACB0\uACFC"}),r.createEl("button",{cls:"result-save-btn",text:"\u{1F4DD} \uB178\uD2B8\uB85C \uC800\uC7A5"}).addEventListener("click",()=>this.saveAsNote(e));let o=this.resultContainer.createDiv({cls:"result-content"});E.MarkdownRenderer.render(this.app,e,o,"",this.renderComponent)}}showError(e){if(this.progressContainer&&this.progressContainer.addClass("hidden"),this.resultContainer){this.resultContainer.removeClass("hidden"),this.resultContainer.empty();let r=this.resultContainer.createDiv({cls:"result-error"});r.createEl("h3",{text:"\u274C \uC624\uB958 \uBC1C\uC0DD"}),r.createEl("p",{text:e})}}async saveAsNote(e){var u,p;let r=D.getCurrentDateString(),a=D.getCategoryName(this.selectedCategory),o=((u=this.selectedTemplate)==null?void 0:u.name)||"analysis",s=this.settings.reportNaming.replace("{{category}}",this.selectedCategory).replace("{{date}}",r);s=`${s}.md`;let i=this.settings.reportSavePath,l=`${i}/${s}`;this.app.vault.getAbstractFileByPath(i)||await this.app.vault.createFolder(i);let c=`---
type: ai-analysis
category: ${this.selectedCategory}
template: ${((p=this.selectedTemplate)==null?void 0:p.id)||"unknown"}
provider: ${this.selectedProvider}
date: ${r}
---

# ${a} \uBD84\uC11D \uB9AC\uD3EC\uD2B8

> \uC0DD\uC131\uC77C\uC2DC: ${new Date().toLocaleString("ko-KR")}
> \uD15C\uD50C\uB9BF: ${o}

${e}
`;try{if(this.app.vault.getAbstractFileByPath(l)){let g=Date.now(),h=s.replace(".md",`_${g}.md`);await this.app.vault.create(`${i}/${h}`,c),new E.Notice(`\uB9AC\uD3EC\uD2B8\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4: ${h}`)}else await this.app.vault.create(l,c),new E.Notice(`\uB9AC\uD3EC\uD2B8\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4: ${s}`)}catch(m){new E.Notice(`\uC800\uC7A5 \uC2E4\uD328: ${m instanceof Error?m.message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958"}`)}}onClose(){let{contentEl:e}=this;e.empty(),this.renderComponent.unload()}};var Qr='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/><circle cx="12" cy="12" r="3"/></svg>',Ce=class extends De.Plugin{constructor(){super(...arguments);this.timerManager=new ie;this.fileUpdater=null;this.fileCreator=null;this.ribbonIconEl=null;this.settings=ut}async onload(){await this.loadSettings(),this.fileUpdater=new le(this.app),this.fileCreator=new Q(this.app,this.settings),(0,De.addIcon)("life-log",Qr),this.registerMarkdownCodeBlockProcessor("life-log",(e,r,a)=>{this.processWorkoutBlock(e,r,a)}),this.registerMarkdownCodeBlockProcessor("study-log",(e,r,a)=>{this.processStudyBlock(e,r,a)}),this.registerMarkdownCodeBlockProcessor("work-log",(e,r,a)=>{this.processWorkBlock(e,r,a)}),this.registerMarkdownCodeBlockProcessor("meal-log",(e,r,a)=>{this.processMealBlock(e,r,a)}),this.addCommand({id:"open-quick-log",name:"\uC0C8 \uAE30\uB85D",hotkeys:[{modifiers:["Mod","Shift"],key:"l"}],callback:()=>{this.fileCreator&&new B(this.app,this.settings,this.fileCreator).open()}}),this.addCommand({id:"open-study-log",name:"\uC0C8 \uD559\uC2B5 \uAE30\uB85D",callback:()=>{this.fileCreator&&new B(this.app,{...this.settings,defaultTab:"study"},this.fileCreator).open()}}),this.addCommand({id:"open-work-log",name:"\uC0C8 \uC5C5\uBB34 \uAE30\uB85D",callback:()=>{this.fileCreator&&new B(this.app,{...this.settings,defaultTab:"work"},this.fileCreator).open()}}),this.addCommand({id:"open-workout-log",name:"\uC0C8 \uC6B4\uB3D9 \uAE30\uB85D",callback:()=>{this.fileCreator&&new B(this.app,{...this.settings,defaultTab:"workout"},this.fileCreator).open()}}),this.addCommand({id:"open-ai-analysis",name:"AI \uBD84\uC11D",hotkeys:[{modifiers:["Mod","Shift"],key:"a"}],callback:()=>{new Ee(this.app,this.settings.aiAnalysis,this.settings.logFolder).open()}}),console.log("[Life Log] Registering settings tab..."),this.addSettingTab(new ye(this.app,this)),console.log("[Life Log] Settings tab registered"),this.updateRibbonIcon()}onunload(){this.timerManager.destroy()}async loadSettings(){let e=await this.loadData();this.settings=Object.assign({},ut,e),(!this.settings.subjects||this.settings.subjects.length===0)&&(this.settings.subjects=[...dt]),(!this.settings.workoutTemplates||this.settings.workoutTemplates.length===0)&&(this.settings.workoutTemplates=[...ke]),this.settings.aiAnalysis?this.settings.aiAnalysis=Object.assign({},X,this.settings.aiAnalysis):this.settings.aiAnalysis={...X}}async saveSettings(){await this.saveData(this.settings),this.fileCreator&&(this.fileCreator=new Q(this.app,this.settings))}updateRibbonIcon(){this.ribbonIconEl&&(this.ribbonIconEl.remove(),this.ribbonIconEl=null),this.settings.showRibbonIcon&&(this.ribbonIconEl=this.addRibbonIcon("life-log","Life Log: \uC0C8 \uAE30\uB85D",()=>{this.fileCreator&&new B(this.app,this.settings,this.fileCreator).open()}))}processWorkoutBlock(e,r,a){var u;let o=oe(e),s=a.getSectionInfo(r),i=`${a.sourcePath}:${(u=s==null?void 0:s.lineStart)!=null?u:0}`,l=this.timerManager.isTimerRunning(i);if(l&&o.metadata.state!=="started")this.timerManager.stopWorkoutTimer(i);else if(l&&o.metadata.state==="started"){let p=o.exercises.findIndex(g=>g.state==="inProgress"),m=this.timerManager.getActiveExerciseIndex(i);p>=0&&p!==m&&this.timerManager.setActiveExerciseIndex(i,p)}let d=this.createWorkoutCallbacks(a,s,o,i),c=this.settings.usePerTypeTimerStyle?this.settings.workoutTimerStyle:this.settings.timerStyle;Dt({el:r,parsed:o,callbacks:d,workoutId:i,timerManager:this.timerManager,timerStyle:c})}processStudyBlock(e,r,a){var u;let o=ce(e),s=a.getSectionInfo(r),i=`study:${a.sourcePath}:${(u=s==null?void 0:s.lineStart)!=null?u:0}`,l=this.timerManager.isTimerRunning(i);if(l&&o.metadata.state!=="started")this.timerManager.stopWorkoutTimer(i);else if(l&&o.metadata.state==="started"){let p=o.tasks.findIndex(g=>g.state==="inProgress"),m=this.timerManager.getActiveExerciseIndex(i);p>=0&&p!==m&&this.timerManager.setActiveExerciseIndex(i,p)}let d=this.createStudyCallbacks(a,s,o,i),c=this.settings.usePerTypeTimerStyle?this.settings.studyTimerStyle:this.settings.timerStyle;$t({el:r,parsed:o,callbacks:d,studyId:i,timerManager:this.timerManager,enableTimerSound:this.settings.enableTimerSound,enableNotification:this.settings.enableNotifications,timerStyle:c})}processWorkBlock(e,r,a){var u;let o=me(e),s=a.getSectionInfo(r),i=`work:${a.sourcePath}:${(u=s==null?void 0:s.lineStart)!=null?u:0}`,l=this.timerManager.isTimerRunning(i);if(l&&o.metadata.state!=="started")this.timerManager.stopWorkoutTimer(i);else if(l&&o.metadata.state==="started"){let p=o.tasks.findIndex(g=>g.state==="inProgress"),m=this.timerManager.getActiveExerciseIndex(i);p>=0&&p!==m&&this.timerManager.setActiveExerciseIndex(i,p)}let d=this.createWorkCallbacks(a,s,o,i),c=this.settings.usePerTypeTimerStyle?this.settings.workTimerStyle:this.settings.timerStyle;Bt({el:r,parsed:o,callbacks:d,workId:i,timerManager:this.timerManager,enableTimerSound:this.settings.enableTimerSound,enableNotification:this.settings.enableNotifications,timerStyle:c})}createWorkCallbacks(e,r,a,o){let s=a,i=!1,l=async c=>{var m;s=c,i=!1;let u=Wt(c),p=s.metadata.title;await((m=this.fileUpdater)==null?void 0:m.updateCodeBlock(e.sourcePath,r,u,p))};return{onStartWork:async()=>{i=!1,s.metadata.state="started",s.metadata.startDate=this.formatStartDate(new Date);let c=s.tasks.findIndex(u=>u.state==="pending");c>=0&&(s=z(s,c,"inProgress")),await l(s),this.timerManager.startWorkoutTimer(o,c>=0?c:0)},onFinishWork:async()=>{let c=this.timerManager.getTimerState(o);c&&(s.metadata.totalDuration=x(c.workoutElapsed)),s.metadata.endDate=this.formatStartDate(new Date),s.metadata.state="completed";for(let u=0;u<s.tasks.length;u++){let p=s.tasks[u];if(p&&p.state==="inProgress"){let m=this.timerManager.getTimerState(o);m&&(s=ge(s,u,x(m.exerciseElapsed))),s=z(s,u,"completed")}}await l(s),this.timerManager.stopWorkoutTimer(o)},onTaskFinish:async c=>{if(i=!1,!s.tasks[c])return;let p=this.timerManager.getTimerState(o);p&&(s=ge(s,c,x(p.exerciseElapsed))),s=z(s,c,"completed");let m=s.tasks.findIndex((g,h)=>h>c&&g.state==="pending");m>=0?(s=z(s,m,"inProgress"),this.timerManager.advanceExercise(o,m),await l(s)):await l(s)},onTaskSkip:async c=>{i=!1;let u=this.timerManager.getTimerState(o);u&&u.exerciseElapsed>0&&(s=ge(s,c,x(u.exerciseElapsed))),s=z(s,c,"skipped");let p=s.tasks.findIndex((m,g)=>g>c&&m.state==="pending");p>=0?(s=z(s,p,"inProgress"),this.timerManager.advanceExercise(o,p),await l(s)):await l(s)},onPauseTask:()=>{this.timerManager.pauseExercise(o)},onResumeTask:()=>{this.timerManager.resumeExercise(o)},onFlushChanges:async()=>{i&&await l(s)}}}createWorkoutCallbacks(e,r,a,o){let s=a,i=!1,l=async c=>{var m;s=c,i=!1;let u=$e(c),p=s.metadata.title;await((m=this.fileUpdater)==null?void 0:m.updateCodeBlock(e.sourcePath,r,u,p))};return{onStartWorkout:async()=>{i=!1,s.metadata.state="started",s.metadata.startDate=this.formatStartDate(new Date);let c=s.exercises.findIndex(u=>u.state==="pending");if(c>=0){let u=s.exercises[c];u&&(u.state="inProgress")}await l(s),this.timerManager.startWorkoutTimer(o,c>=0?c:0)},onFinishWorkout:async()=>{let c=this.timerManager.getTimerState(o);c&&(s.metadata.duration=x(c.workoutElapsed)),s.metadata.state="completed",s=se(s),await l(s),this.timerManager.stopWorkoutTimer(o)},onExerciseFinish:async c=>{if(i=!1,!s.exercises[c])return;let p=this.timerManager.getTimerState(o);p&&(s=q(s,c,x(p.exerciseElapsed))),s=R(s,c,"completed");let m=s.exercises.findIndex((g,h)=>h>c&&g.state==="pending");if(m>=0)s=R(s,m,"inProgress"),this.timerManager.advanceExercise(o,m),await l(s);else{s.metadata.state="completed";let g=this.timerManager.getTimerState(o);g&&(s.metadata.duration=x(g.workoutElapsed)),s=se(s),await l(s),this.timerManager.stopWorkoutTimer(o)}},onExerciseAddSet:async c=>{if(i=!1,!s.exercises[c])return;let p=this.timerManager.getTimerState(o);p&&(s=q(s,c,x(p.exerciseElapsed))),s=R(s,c,"completed"),s=St(s,c),s=R(s,c+1,"inProgress"),this.timerManager.advanceExercise(o,c+1),await l(s)},onExerciseAddRest:async c=>{i=!1;let u=s.exercises[c],p=s.metadata.restDuration;if(!u||!p)return;let m=this.timerManager.getTimerState(o);m&&(s=q(s,c,x(m.exerciseElapsed))),s=R(s,c,"completed"),s=vt(s,c,p),s=R(s,c+1,"inProgress"),this.timerManager.advanceExercise(o,c+1),await l(s)},onExerciseSkip:async c=>{i=!1;let u=this.timerManager.getTimerState(o);u&&u.exerciseElapsed>0&&(s=q(s,c,x(u.exerciseElapsed))),s=R(s,c,"skipped");let p=s.exercises.findIndex((m,g)=>g>c&&m.state==="pending");if(p>=0)s=R(s,p,"inProgress"),this.timerManager.advanceExercise(o,p),await l(s);else{s.metadata.state="completed";let m=this.timerManager.getTimerState(o);m&&(s.metadata.duration=x(m.workoutElapsed)),s=se(s),this.timerManager.stopWorkoutTimer(o),await l(s)}},onParamChange:(c,u,p)=>{let m=s.exercises[c],g=m==null?void 0:m.params.find(h=>h.key===u);(g==null?void 0:g.value)!==p&&(s=kt(s,c,u,p),i=!0)},onFlushChanges:async()=>{i&&await l(s)},onPauseExercise:()=>{this.timerManager.pauseExercise(o)},onResumeExercise:()=>{this.timerManager.resumeExercise(o)},onAddSample:async()=>{var p;let c=Tt(),u=$e(c);await((p=this.fileUpdater)==null?void 0:p.updateCodeBlock(e.sourcePath,r,u,c.metadata.title))}}}createStudyCallbacks(e,r,a,o){let s=a,i=!1,l=async c=>{var m;s=c,i=!1;let u=Pt(c),p=s.metadata.title;await((m=this.fileUpdater)==null?void 0:m.updateCodeBlock(e.sourcePath,r,u,p))};return{onStartStudy:async()=>{i=!1,s.metadata.state="started",s.metadata.startDate=this.formatStartDate(new Date);let c=s.tasks.findIndex(u=>u.state==="pending");c>=0&&(s=G(s,c,"inProgress")),await l(s),this.timerManager.startWorkoutTimer(o,c>=0?c:0,this.settings.enablePomodoro?{enabled:!0,workDuration:this.settings.pomodoroWork*60,breakDuration:this.settings.pomodoroBreak*60}:void 0)},onFinishStudy:async()=>{let c=this.timerManager.getTimerState(o);c&&(s.metadata.totalDuration=x(c.workoutElapsed)),s.metadata.endDate=this.formatStartDate(new Date),s.metadata.state="completed",await l(s),this.timerManager.stopWorkoutTimer(o)},onTaskFinish:async c=>{if(i=!1,!s.tasks[c])return;let p=this.timerManager.getTimerState(o);p&&(s=de(s,c,x(p.exerciseElapsed))),s=G(s,c,"completed");let m=s.tasks.findIndex((g,h)=>h>c&&g.state==="pending");m>=0?(s=G(s,m,"inProgress"),this.timerManager.advanceExercise(o,m),await l(s)):await l(s)},onTaskSkip:async c=>{i=!1;let u=this.timerManager.getTimerState(o);u&&u.exerciseElapsed>0&&(s=de(s,c,x(u.exerciseElapsed))),s=G(s,c,"skipped");let p=s.tasks.findIndex((m,g)=>g>c&&m.state==="pending");p>=0?(s=G(s,p,"inProgress"),this.timerManager.advanceExercise(o,p),await l(s)):await l(s)},onPauseTask:()=>{this.timerManager.pauseExercise(o)},onResumeTask:()=>{this.timerManager.resumeExercise(o)},onFlushChanges:async()=>{i&&await l(s)},onOpenSelfEval:()=>{new be(this.app,async c=>{s=Mt(s,c.focusScore,c.comprehensionScore);let u=this.timerManager.getTimerState(o);u&&(s.metadata.totalDuration=x(u.workoutElapsed)),s.metadata.endDate=this.formatStartDate(new Date),s.metadata.state="completed";for(let p=0;p<s.tasks.length;p++){let m=s.tasks[p];if(m&&m.state==="inProgress"){let g=this.timerManager.getTimerState(o);g&&(s=de(s,p,x(g.exerciseElapsed))),s=G(s,p,"completed")}}await l(s),this.timerManager.stopWorkoutTimer(o)}).open()}}}formatStartDate(e){let r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return`${r}-${a}-${o} ${s}:${i}`}processMealBlock(e,r,a){var d;let o=he(e),s=a.getSectionInfo(r),i=`meal:${a.sourcePath}:${(d=s==null?void 0:s.lineStart)!=null?d:0}`,l=this.createMealCallbacks(a,s,o,i);Gt({el:r,parsed:o,callbacks:l,mealId:i,app:this.app})}createMealCallbacks(e,r,a,o){let s=a,i=async l=>{var u;s=l;let d=Ht(l),c=s.metadata.title;await((u=this.fileUpdater)==null?void 0:u.updateCodeBlock(e.sourcePath,r,d,c))};return{onCompleteMeal:async()=>{s.metadata.state="completed",s.metadata.date||(s.metadata.date=this.formatStartDate(new Date));for(let l=0;l<s.foods.length;l++){let d=s.foods[l];d&&d.state==="pending"&&(s=nt(s,l))}await i(s)},onFoodToggle:async l=>{s=nt(s,l),await i(s)},onAddFood:async l=>{s=Ot(s,l),await i(s)},onRemoveFood:async l=>{s=Nt(s,l),await i(s)},onPhotoChange:async l=>{s=jt(s,l),await i(s)},onFlushChanges:async()=>{}}}};
